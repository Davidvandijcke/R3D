% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/r3d_bootstrap.R
\name{r3d_bootstrap}
\alias{r3d_bootstrap}
\title{Multiplier Bootstrap for Distributional RDD}
\usage{
r3d_bootstrap(
  object,
  X,
  Y_list,
  T = NULL,
  B = 200,
  alpha = 0.05,
  test = c("none", "nullity", "homogeneity"),
  cores = 1,
  seed = NULL,
  ...
)
}
\arguments{
\item{object}{An S3 object of class \code{"r3d"}, typically the output of \code{\link{r3d}}.}

\item{X}{Numeric vector of the running variable (the same one used in \code{\link{r3d}}).}

\item{Y_list}{A list of numeric vectors; each element in this list is the sample from the
outcome distribution of one unit (same data passed to \code{\link{r3d}}).}

\item{T}{(Optional) numeric or logical vector of treatment statuses for the fuzzy design;
used only if the original \code{r3d} call was fuzzy. Otherwise, can be \code{NULL}.}

\item{B}{Integer, number of bootstrap draws. Defaults to 200.}

\item{alpha}{Significance level for uniform confidence bands. Defaults to 0.05.}

\item{test}{Character indicating which hypothesis test to conduct:
\describe{
\item{\code{"none"}}{No test, only compute confidence bands.}
\item{\code{"nullity"}}{Tests the null \eqn{H_0: \tau(q) = 0 \text{ for all } q}.}
\item{\code{"homogeneity"}}{Tests the null \eqn{H_0: \tau(q) \text{ is constant in } q}.}
}}

\item{cores}{Number of CPU cores used for parallel computation of bootstrap draws (default 1).}

\item{seed}{Optional integer to set a random seed for the multiplier draws (for reproducibility).}

\item{...}{Unused additional arguments (for compatibility).}
}
\value{
A list with the elements:
\describe{
\item{\code{cb_lower}, \code{cb_upper}}{Numeric vectors giving the lower and upper
uniform confidence bands at each quantile in \code{object$q_grid}.}
\item{\code{boot_taus}}{A matrix of bootstrap-draw realizations of the entire \eqn{\tau(q)}.}
\item{\code{supvals}}{For each bootstrap draw, the supremum (max) absolute deviation.}
\item{\code{crit_val}}{The critical value (e.g., the \code{(1 - alpha)} quantile of \code{supvals}).}
\item{\code{test_stat}, \code{test_crit_val}, \code{p_value}}{If \code{test != "none"},
these store the test statistic, critical value, and a simple bootstrap-based p-value.}
}
}
\description{
Performs a multiplier bootstrap to obtain uniform confidence bands
and (optionally) conduct hypothesis tests for an \emph{R3D} or \emph{F3D} design.
It reuses the partial-sum intercept weights and residuals from a fitted \code{r3d} object
to avoid re-estimating local polynomial regressions within each bootstrap loop.
}
\details{
This function implements the multiplier bootstrap approach for distributional RD:
it draws i.i.d. normal multipliers \eqn{\xi_i}, re-scales the stored residual partial sums,
and reconstructs approximate realizations of the limiting process.
The maximum deviation across quantiles in each realization
is then used to form uniform confidence bands and test statistics.

For the fuzzy design, the ratio-based estimator is handled similarly, using
the same partial-sum logic for the treatment variable.
}
\seealso{
\code{\link{r3d}}, \code{\link{plot.r3d}}, \code{\link{summary.r3d}}
}
