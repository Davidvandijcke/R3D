% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/r3d_main.R
\name{r3d}
\alias{r3d}
\title{Main function for R3D: Local polynomial regression at a cutoff for distributional RD}
\usage{
r3d(
  X,
  Y_list,
  T = NULL,
  cutoff = 0,
  method = c("simple", "frechet"),
  p = 2,
  q_grid = seq(0.1, 0.9, 0.1),
  fuzzy = FALSE,
  kernel = function(u) pmax(0, 1 - abs(u)),
  s = 1,
  boot = FALSE,
  boot_reps = 200,
  boot_cores = 1,
  alpha = 0.05,
  test = c("none", "nullity", "homogeneity"),
  ...
)
}
\arguments{
\item{X}{Numeric vector of the running variable.}

\item{Y_list}{List of numeric vectors representing each unit's outcome distribution.}

\item{T}{Optional numeric vector (same length as X) for fuzzy RD.}

\item{cutoff}{Numeric, default 0. The cutoff for RDD; assumes X is recentered.}

\item{method}{Character, either "simple" for pointwise local polynomial, or "frechet" for Fréchet (L^2-projection).}

\item{p}{Integer polynomial order (typically 1 or 2).}

\item{q_grid}{Numeric vector of quantiles between 0 and 1.}

\item{fuzzy}{Logical, if TRUE performs fuzzy RD estimation.}

\item{kernel}{Function, kernel weight function (default triangular kernel).}

\item{s}{Integer, expansion order for pilot bandwidth selection.}

\item{boot}{Logical, if TRUE performs multiplier bootstrap for uniform confidence bands.}

\item{boot_reps}{Integer, number of bootstrap replicates.}

\item{boot_cores}{Integer, number of CPU cores for bootstrap parallelization.}

\item{alpha}{Numeric, significance level for confidence bands.}

\item{test}{Character, type of test: "none", "nullity", or "homogeneity".}

\item{...}{Additional arguments (currently unused).}
}
\value{
An S3 object of class \code{"r3d"} with elements:
\describe{
\item{tau}{Vector of RD effects at each quantile.}
\item{q_grid}{Quantile grid used.}
\item{method}{Method used ("simple" or "frechet").}
\item{fuzzy}{Logical indicating if fuzzy RD was performed.}
\item{p}{Polynomial order.}
\item{bandwidths}{Bandwidths used for estimation.}
\item{alpha_plus, alpha_minus}{Local polynomial coefficients for each side.}
\item{w_plus, w_minus}{Intercept weights for bootstrap.}
\item{e1_mat, e2_mat}{First-stage residual matrices.}
\item{call}{Original function call.}
}
}
\description{
Implements local polynomial regression at the cutoff (default at X=0) for regression discontinuity designs (RDD)
involving distributional outcomes (quantile functions). Supports simple and Fréchet regression methods, fuzzy designs,
and bootstrap-based inference.
}
\details{
The function first selects bandwidths via \code{r3d_bwselect()}, then for each quantile grid point,
calls the compiled Fortran subroutine \code{locweights} for local polynomial regression.

If \code{fuzzy = TRUE}, the function performs fuzzy RD by calculating ratios of RD effects.

If \code{method = "frechet"}, the final RD effect across quantiles is rearranged monotonically.

If bootstrap is requested (\code{boot=TRUE}), \code{r3d_bootstrap()} computes uniform confidence bands.
}
