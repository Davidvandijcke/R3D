\documentclass[10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[version=4]{mhchem}
\usepackage{stmaryrd}
\usepackage{mathrsfs}
\usepackage{bbold}
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=blue, filecolor=magenta, urlcolor=cyan,}
\urlstyle{same}

\title{GÂTEAUX DIFFERENTIABILITY OF CONE-MONOTONE AND POINTWISE LIPSCHITZ FUNCTIONS* }

\author{BY\\
David Preiss\\
Mathematics Institute, University of Warwick, Coventry CV4 7AL, United Kingdom\\
e-mail:d.preiss@warwick.ac.uk\\
Dedicated to the Memory of Joram Lindenstrauss}
\date{}


%New command to display footnote whose markers will always be hidden
\let\svthefootnote\thefootnote
\newcommand\blfootnotetext[1]{%
  \let\thefootnote\relax\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \let\thefootnote\svthefootnote%
}

%Overriding the \footnotetext command to hide the marker if its value is `0`
\let\svfootnotetext\footnotetext
\renewcommand\footnotetext[2][?]{%
  \if\relax#1\relax%
    \ifnum\value{footnote}=0\blfootnotetext{#2}\else\svfootnotetext{#2}\fi%
  \else%
    \if?#1\ifnum\value{footnote}=0\blfootnotetext{#2}\else\svfootnotetext{#2}\fi%
    \else\svfootnotetext[#1]{#2}\fi%
  \fi
}

\begin{document}
\maketitle


\begin{abstract}
We give a geometric description of the smallest \(\sigma\)-ideal \(\stackrel{\mathscr{C}}{ }\) of subsets of a separable Banach space with respect to which cone-monotone functions are Gâteaux differentiable almost everywhere. We also show that the usual generalizations of Rademacher's and Stepanov's theorems for metric and weak \({ }^{\star}\)-differentiability, as well as for Gâteaux and Hadamard differentiability of functions with values in spaces with the Radon-Nikodym property, hold with the exceptional sets belonging to \(\mathcal{C}\).
\end{abstract}

\section*{Introduction}
This note contributes to the first part of the program Joram Lindenstrauss and I intended to pursue after finishing the joint work with Jaroslav Tišer on the research monograph [19] describing situations when Lipschitz functions have so many Fréchet differentiability points that the closed convex hulls of their Fréchet and Gâteaux derivatives coincide. We agreed that the most promising direction of research is to gain better understanding of Gâteaux differentiability of realvalued Lipschitz functions on separable Banach spaces, or of Lipschitz maps of such spaces to spaces with the Radon-Nikodym property. Results recently

\footnotetext{\begin{itemize}
  \item The research leading to these results has received funding from the European Research Council under the European Union's Seventh Framework Programme (FP/2007-2013) / ERC Grant Agreement n. 291497.
\end{itemize}
}Received June 2, 2013 and in revised form March 3, 2014\\
announced in \([1,9,22]\), which combine to a complete solution of a finite dimensional version of these problems, and in particular the nature of methods indicated in [1] and discussed in detail in [2] give hope for achieving a complete geometric description of the smallest \(\sigma\)-ideal(s) of subsets of a separable Banach space with respect to which functions from various classes are Gâteaux differentiable almost everywhere.

Here we fully realize the above program for the class of cone-monotone functions on separable Banach spaces by showing that the smallest \(\sigma\)-ideal with respect to which such functions are Gâteaux differentiable almost everywhere coincides with the \(\sigma\)-ideal \(\mathcal{C}\) generated by sets "regularly null on curves running in the direction of some open cone" (see Definition 1.1). It follows that realvalued functions are Gâteaux differentiable at \(\mathfrak{C}\)-almost every point at which they are Lipschitz, and standard methods (see [3, 11, 12]) combined with a somewhat involved use of a covering theorem lead to analogous results for metric and weak \({ }^{\star}\)-differentiability, from which one may deduce \(\stackrel{\mathcal{C}}{ }\)-almost everywhere Gâteaux and Hadamard differentiability results for pointwise Lipschitz functions with values in spaces with the Radon-Nikodym property. However, while for cone-monotone functions our results complete investigations of various authors, most notably Borwein, Wang, Burke, Lewis (see, e.g., [8]) and Duda [11], the Lipschitz case is more technical and at the present time it is not clear whether an (obviously highly non-trivial) extension of results of [2] can similarly complete the investigations of Mankiewicz, Christensen, Aronszajn, Phelps (see [5] for more details), Bongiorno [7], Duda [11] and others.

The \(\sigma\)-ideal \(\mathscr{\mathcal { C }}\) is contained in the \(\sigma\)-ideal \(\widetilde{\mathcal{C}}\), for which Rademacher's theorem was proved in [23]. We will define \(\widetilde{\mathcal{C}}\) in remarks after Definition 1.1; here it suffices to say that in spaces with the Radon-Nikodym property one obtains the definition of its generators from that of generators of \(\tilde{\mathcal{C}}\) by removing "regularly" and requiring that the sets be Borel. In infinite dimensional spaces I do not know whether \(\mathscr{\mathcal { C }}=\widetilde{\mathcal{C}}\); in finite dimensional spaces, where our results are a special case of considerably stronger results of [2], the equality \(\tilde{\mathcal{C}}=\widetilde{\mathcal{C}}\) holds because they both coincide with the Lebesgue null sets according to a highly non-trivial result announced by Csörnyei and Jones [9]. More recently, András Mathé proved the equality \(\mathcal{C}=\widetilde{\mathcal{C}}\) in finite dimensional spaces by a much simpler descriptive theoretic argument.

In more details, the results presented here are as follows. In Section 1, in addition to defining the \(\sigma\)-ideal \(\stackrel{\mathcal{C}}{ }\), we give a somewhat unusual estimate of the\\
remainder in the standard " \(5 r\) " covering theorem. This covering statement is crucial for the present development, since it allows to cover the nondifferentiability sets by open sets small on curves, which is the basic difference between the notions of \(\mathcal{\mathcal { C }}\)-null and the previous notion of \(\widetilde{\mathcal{C}}\)-null sets. We also define a subclass of \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-null sets, \(\sigma\)-directionally porous sets, and prove several results in which exceptional sets belong to this class. Here we are interested only in results that are needed in the sequel such as a reduction to separable target (Lemma 1.9), a reduction of the pointwise Lipschitz case of sequences of realvalued functions to the Lipschitz case (Lemma 1.10), and linearity properties in the Lipschitz case (Lemma 1.11). For more systematic studies of results valid with the exception of \(\sigma\)-directionally porous sets, see [23, 24, 25, 20].

In Section 2 we first show that real-valued Lipschitz functions are Gâteaux differentiable \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost everywhere (Proposition 2.3 ), and then, by a similar but considerably more involved argument, the more general Theorem 2.9 on \(\stackrel{\text { ® }}{\mathcal{C}}\) almost everywhere differentiability of sequences of real-valued functions, which could also be understood as speaking about weak \({ }^{\star}\)-differentiability of \(\ell_{\infty}\)-valued functions. The main reason for this is that for the study of the cone-monotone case we need only the easier result while the more difficult one is needed only for the vector-valued case in the last Section.

In Section 3 we show that \(\mathscr{\mathcal { C }}\) is the smallest \(\sigma\)-ideal with respect to which cone-monotone functions are differentiable almost everywhere (Theorem 3.5). In Proposition 3.8 we point out that this implies a basic version of the Denjoy-Young-Saks theorem valid in this context. A more complete version of this theorem, such as the one presented by L. Zajíček [26] for a different class of null sets at the conference "Banach spaces: geometry and analysis" held in Jerusalem in May 2013, may be obtained for the \(\mathcal{\mathcal { C }}\)-null sets by combining the basic version with differentiability results without any essential change to his arguments.

Section 4 studies differentiability properties of maps from separable Banach spaces at points at which they are Lipschitz. Here we need the full strength of the key statements of Section 2, which for the real-valued case treated so far was needed for constant sequences (that is, for a single function) only. Theorem 2.9 leads directly to a weak \({ }^{\star}\) differentiability result of Theorem 4.1. A metric differentiability result, Theorem 4.4, even in a Hadamard-Kirchheim form, is an immediate corollary. To prove Gâteaux or Hadamard differentiability for functions with values in spaces with the Radon-Nikodym property,

Theorems 4.2 and 4.3 , we combine Theorem 4.1 with the powerful description of the Radon-Nikodym property proved by Ghoussoub and Maurey [14]. In a converse direction to Theorem 4.1, the final Proposition 4.5 shows that \(\tilde{\mathcal{C}}\) is the smallest \(\sigma\)-ideal with respect to which Lipschitz functions are weak \({ }^{\star}\) differentiable almost everywhere.

\section*{1. Definitions and preliminary results}
Most of the notation and terminology we use is reasonably standard. We say that a map \(f\) between metric spaces \(M\) and \(N\) is Lipschitz at a point \(x \in M\) if

\[
\operatorname{Lip}_{x}(f)=\operatorname{Lip}_{x}(f, M):=\limsup _{y \rightarrow x} \frac{\operatorname{dist}(f(y), f(x))}{\operatorname{dist}(y, x)}<\infty
\]

and we say that \(f\) is Lipschitz if

\[
\operatorname{Lip}(f)=\operatorname{Lip}(f, M):=\sup _{x, y \in M ; x \neq y} \frac{\operatorname{dist}(f(y), f(x))}{\operatorname{dist}(y, x)}<\infty
\]

As usual, we set \(\sup \emptyset=0\) in the highly noninteresting cases when it occurs in the above formulas; so \(\operatorname{Lip}_{x}(f, M)=0\) if \(x\) is an isolated point of \(M\) and \(\operatorname{Lip}(f, M)=0\) if \(M\) has just one point.

The open unit ball and the unit sphere in a Banach space \(X\) are denoted \(\mathcal{B}_{X}\) and \(\mathcal{S}_{X}\), respectively, and \(B(x, r)=B_{X}(x, r):=x+r \mathcal{B}_{X}\). If \(X, Y\) are Banach spaces, directional derivatives of \(f: X \rightarrow Y\) are denoted \(f^{\prime}(x ; e)\) and defined by

\[
f^{\prime}(x ; e):=\lim _{t \rightarrow 0} \frac{f(x+t e)-f(x)}{t}
\]

The map \(f: X \rightarrow Y\) is said to be Gâteaux differentiable at \(x\) if \(f^{\prime}(x ; e)\) exists for every \(e \in X\) and, as a function of \(e\), it is a continuous linear map, which is denoted \(f^{\prime}(x)\), of \(X\) to \(Y\). For real-valued \(f, \bar{D} f(x ; e)\), respectively \(\underline{D} f(x ; e)\), denote upper, respectively lower, directional derivatives; unlike derivatives, they may attain values \(\pm \infty\). Finally, a map \(f\) of \(E \subset X\) to \(Y\) is said to be Hadamard differentiable at \(x\) if there is a bounded linear map \(T: X \rightarrow Y\) such that for every \(e \in X\) and \(\varepsilon>0\) there is \(\delta>0\) with the property that

\[
\|f(x+t u)-f(x)-T(t e)\| \leq \varepsilon|t|
\]

whenever \(x+t u \in E,\|u-e\|<\delta\) and \(|t|<\delta\). Clearly, if \(x\) is an interior point of \(E\), Hadamard differentiability implies Gâteaux differentiability.

A perhaps more illuminating definition of the Hadamard differentiability as a limit of slopes may be obtained by dividing (1) through \(|t|\) and rearranging. So \(f\) is Hadamard differentiable at \(x\) if and only if there is a bounded linear map \(T: X \rightarrow Y\) such that

\[
\lim _{k \rightarrow \infty} \frac{f\left(x+t_{k} u_{k}\right)-f(x)}{t_{k}}=T(u)
\]

whenever \(u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\). To be formally correct, we should have also said \(t_{k} \neq 0\), but in this and similar situations we tend not to do it, since it is obvious from the context and stating it just obfuscates matters. Notice that other authors, who work in the case when \(x\) is the interior point of \(E\), also use similar agreements. For example, [16] writes \(T(u)=\lim _{(t, v) \rightarrow(0, u)}(f(x+t v)-f(x)) / t\), which formally allows \(t=0\), while \([24,25,26]\) has \(T(u)=\lim _{v \rightarrow u, t \rightarrow 0}(f(x+t v)-f(x)) / t\), which formally disallows not only \(t=0\) but also \(v=u\).

For us, a cone in a Banach space \(X\) will be a nonempty open set \(C \subset X\) such that \(a x+b y \in C\) for every \(x, y \in C\) and \(a, b>0\). We will mostly use the cones

\[
C(e, \tau)=\{x \in X:\|x-t e\|<\tau t \text { for some } t>0\}
\]

where \(e \in X\) has norm one and \(0<\tau<1\). Since all our notions will be inherited by smaller cones, not much would be lost if "cone" meant just one of the \(C(e, \tau)\).

If \(C\) is a cone in \(X\) and \(I \subset \mathbb{R}\) is an interval, we denote by \(\Gamma_{C}(I, X)\) the set of \(C^{1}\) curves \(\gamma: I \rightarrow X\) such that \(\left\|\gamma^{\prime}(t)\right\|=1\) and \(\gamma^{\prime}(t) \in C\) for every \(t \in I\). When \(I=\mathbb{R}\), we simplify the notation to \(\Gamma_{C}(X)\) or even to \(\Gamma_{C}\), since \(X\) is usually clear from the context.

Definition 1.1: Let \(N\) be a subset of a separable Banach space \(X\).\\
(i) We will say that \(N\) is regularly null in the direction of a cone \(C\), or regularly \(C\)-null, if for every \(\varepsilon>0\) there is an open set \(G \supset N\) such that \(\left|\gamma^{-1}(G)\right|<\varepsilon\) (where \(|\cdot|\) denotes the Lebesgue measure) for every \(\gamma \in \Gamma_{C}\).\\
(ii) We will say that \(N\) is \(\stackrel{\mathscr{C}}{ }\)-null if it is a union of countably many sets each of which is regularly null in the direction of some cone (which may be different for different sets).

Remark 1.2: There are many ways in which the requirement in (i) can be modified to yield the same notion of \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-null sets. We state some of them; they can be easily proved by reparametrization and/or approximation.\\
(a) Perhaps the most natural reformulation of (i) is to replace \(\Gamma_{C}(X)\) with the set \(\mathrm{AC}_{C}\) of absolutely continuous mappings \(\gamma: \mathbb{R} \rightarrow X\) such that \(\gamma(t)-\gamma(s) \in C\) for every \(t>s\), and at the same time replace the requirement \(\left|\gamma^{-1}(G)\right|<\varepsilon\) by requesting the one-dimensional Hausdorff measure of the intersection of \(G\) with the image of \(\gamma\) to be \(<\varepsilon\). The Hausdorff measure conditions is equivalent to \(\int\left\|g^{\prime}(t)\right\| d t<\varepsilon\), where in spaces without the Radon-Nikodym property \(\left\|g^{\prime}(t)\right\|\) should be understood as the metric derivative of \(g\) at \(t\).\\
(b) If we wish to keep the requirement \(\left|\gamma^{-1}(G)\right|<\varepsilon\), we may replace \(\Gamma_{C}\) by fixing \(0<\alpha \leq \beta<\infty\) and considering either the set of Lipschitz almost everywhere differentiable maps \(\gamma: \mathbb{R} \rightarrow X\) such that \(\gamma^{\prime}(t) \in C\) and \(\alpha \leq\left\|\gamma^{\prime}(t)\right\| \leq \beta\) for almost every \(t\), or the set of piecewise affine maps having these properties.\\[0pt]
(c) For finer results such as those of [2], where this notion is studied in a finite dimensional situation, it is often convenient to replace \(\left|\gamma^{-1}(G)\right|<\varepsilon\) by \(\int_{\gamma^{-1}(G)} M\left(\gamma^{\prime}(t)\right) d t<\varepsilon\), where \(M\) measures not only the size of \(\gamma^{\prime}(t)\) but also its position inside \(C\).\\
(d) Finally, a simple but useful modification, which we will use without any reference, is to fix a (bounded) interval \(I\) and require \(\left|I \cap \gamma^{-1}(G)\right|<\varepsilon\) for \(\gamma \in \Gamma_{C}\). To justify this, it suffices to consider only cones \(C(e, \tau)\) (where, as always, \(\|e\|=1\) and \(0<\tau<1\) ). Letting \(r=\frac{1}{2}(1-\tau)|I|\), we have \(\operatorname{diam}\left(\gamma^{-1}(B(x, r)) \leq|I|\right.\) for any \(\gamma \in \Gamma_{C}\); hence \(N \cap B(x, r)\) is \(\mathcal{\mathcal { C }}\)-null for every \(x \in X\) and \(N\) is \(\stackrel{\mathscr{C}}{ }\)-null by the Lindelöf property of separable metric spaces. In other words, this argument shows that we may replace \(\Gamma_{C}\) by \(\Gamma_{C}(I, X)\).

Remark 1.3: As already pointed out in the introduction, the notion of \(\mathscr{\mathcal { C }}\)-null sets develops the idea behind the definition of \(\widetilde{\mathcal{C}}\)-null sets from [23]: a Borel set \(N\) is \(C\)-null if \(\left|\gamma^{-1}(N)\right|=0\) for every \(\gamma \in \mathrm{AC}_{C}\), and a set that can be covered by countably many Borel sets each of which is \(C\)-null for some cone \(C\) is termed \(\widetilde{\mathcal{C}}\)-null. By the point (a) of the preceding remark, every \(\mathcal{\mathcal { C }}\)-null set is \(\widetilde{\mathcal{C}}\)-null.

Using an idea originating with Aronszajn [4], [23] defines yet another \(\sigma\)-ideal, called \(\widetilde{\mathcal{A}}\), which is contained in \(\widetilde{\mathcal{C}}\) but it is not known whether \(\widetilde{\mathcal{A}}=\widetilde{\mathcal{C}}\) or not. A Borel set \(N\) belongs to \(\widetilde{\mathcal{A}}\) if for any set \(D \subset X\) with a dense span, \(N\) can be covered by Borel sets \(N_{i}\) each of which is \(C_{i}\)-null for some cone \(C_{i}\) meeting \(D\). Replacing \(C_{i}\)-null by regularly \(C_{i}\)-null, we may similarly define a \(\sigma\)-ideal\\
\(\mathcal{A}\) contained in the \(\sigma\)-ideal of \(\mathcal{\mathcal { C }}\)-null sets. Then [23, Theorem 2] together with the arguments used to prove Theorem 4.2 (using Lemma 2.7 and GhoussoubMaurey description of the Radon-Nikodym property to prove differentiability in the given spanning set of directions) would show that the results on Gâteaux differentiability of Lipschitz mappings hold \(\mathcal{A}\)-almost everywhere. We do not give the details, since it seems that the methods from [2] can be modified to prove that \(\stackrel{\mathcal{A}}{=} \stackrel{\mathcal{C}}{ }\). The modifications are rather lengthy and technical, and are not included here since it appears their further development could lead to showing that in Hilbert spaces, or possibly even in a class of Banach spaces including the superreflexive ones, \(\stackrel{\mathcal{C}}{ }\) is the smallest \(\sigma\)-ideal for which Rademacher's theorem holds.

Lemma 1.4: If \(N\) is a subset of a separable Banach space \(X\) such that for every \(x \in N\) there is \(r>0\) for which \(N \cap B(x, r)\) is regularly \(C\)-null, then \(N\) is regularly \(C\)-null.

Proof. By the Lindelöf property of \(X\) find \(x_{i}, r_{i}\) such that \(X=\bigcup_{i=1}^{\infty} B\left(x_{i}, r_{i}\right)\) and \(N \cap B\left(x_{i}, r_{i}\right)\) is regularly \(C\)-null. Hence, given \(\varepsilon>0\), there are open sets \(G_{i} \supset N \cap B\left(x_{i}, r_{i}\right)\) such that \(\left|\gamma^{-1}\left(G_{i}\right)\right|<2^{-i} \varepsilon\) for every \(\gamma \in \Gamma_{C}\). Then \(G:=\bigcup_{i=1}^{\infty} G_{i} \supset N\) is open and \(\left|\gamma^{-1}(G)\right|<\varepsilon\).

When considering the behaviour of function on cones, we often use the following very trivial statement without any reference.

Lemma 1.5: Let \(0<\tau<1,\|e\|=1\) and \(x, y \in X\). Then \((x+t e)-y\) and \(y-(x-t e)\) belong to \(C(e, \tau)\) for every \(t>\|y-x\| / \tau\).

Proof. \(\|((x+t e)-y)-t e\|<\tau t\) and \(\|(y-(x-t e))-t e\|<\tau t\).

Covering Lemmas. We will need a simple but slightly less usual estimate of the remaining measure in the standard " \(5 r\) " covering theorem (see, for example, [13, Theorem 2.8.4] or for a less general version [21, Theorem 2.1]). We state it first in an abstract setting and then in a special setting for families of intervals in which it will be actually used.

Lemma 1.6: Let \(\lambda\) be a bounded positive function on a family \(\mathcal{J}\) of nonempty subsets of a set \(S\). Then \(\mathcal{J}\) contains a disjoint subfamily \(\mathcal{I}\) having the following property. Whenever \(m, n \in \mathbb{N}, \sigma>1>\eta>0\) and \(J_{0}, \ldots, J_{m n} \in \mathcal{J}\) satisfy\\
\(\bigcap_{k=0}^{m n} J_{k} \neq \emptyset\) and \(\lambda\left(J_{k}\right) \leq \eta \lambda\left(J_{k-1}\right)\) for \(k=1, \ldots, m n\), then at least one of the following statements holds.\\
(i) There are different \(I_{0}, \ldots, I_{n} \in \mathcal{I}\) and \(0 \leq k_{0} \leq \cdots \leq k_{n} \leq m n\) such that \(J_{k_{j}} \cap I_{j} \neq \emptyset\) and \(\lambda\left(J_{k_{j}}\right) \leq \sigma \lambda\left(I_{j}\right)\) for every \(j=0, \ldots, n\).\\
(ii) There are \(I \in \mathcal{I}\) and \(0 \leq k \leq m n\) with \(J_{k} \cap I \neq \emptyset\) and \(\lambda\left(J_{k}\right) \leq \sigma \eta^{m} \lambda(I)\).

Proof. By [13, Theorem 2.8.4] there is a disjoint subfamily \(\mathcal{I}\) such that for every \(J \in \mathcal{J}\) there is \(I \in \mathcal{I}\) with \(I \cap J \neq \emptyset\) and \(\lambda(J) \leq \sigma \lambda(I)\). We show that any such family \(\mathcal{I}\) has the required property.

Suppose \(m, n, \sigma, \eta\) and \(J_{0}, \ldots, J_{m n}\) are as in the lemma. For \(j=0, \ldots, n\) choose \(I_{j} \in \mathcal{I}\) so that \(J_{j m} \cap I_{j} \neq \emptyset\) and \(\lambda\left(J_{j m}\right) \leq \sigma \lambda\left(I_{j}\right)\). If the sets \(I_{j}\), \(j=0, \ldots, n\), are mutually different, (i) holds. In the opposite case there are \(i<j\) such that \(I_{i}=I_{j}\); hence \(J_{j m} \cap I_{i} \neq \emptyset\) and (ii) holds because \(\lambda\left(J_{j m}\right) \leq\) \(\eta^{m} \lambda\left(J_{i m}\right) \leq \sigma \eta^{m} \lambda\left(I_{i}\right)\).

We will use the previous Lemma only in the following special case, which can be considered as a discretized version of the Vitali Covering Theorem.

Lemma 1.7: For every \(\eta_{0}>0\) there is \(q \in \mathbb{N}\) with the following property. Suppose \(E\) is a subset of an interval \((a, b)\) and for every \(t \in E\) we are given intervals \((a, b) \supset J_{0}(t) \supset \cdots \supset J_{q}(t)\) containing \(t\) such that \(\left|J_{k}(t)\right| \leq \frac{1}{2}\left|J_{k-1}(t)\right|\) for every \(k=1, \ldots, q\). Then the family \(\left\{J_{k}(t): t \in E, k=0, \ldots, q\right\}\) contains a finite disjoint subcollection \(\mathcal{I}\) such that

\[
\mid \bigcup\left\{J_{q}(t): J_{q}(t) \text { is not contained in an interval from } \mathcal{I}\right\} \mid<\eta_{0}(b-a)
\]

Proof. We choose \(m, n \in \mathbb{N}\) with \(\eta_{0} n>10\) and \(2^{4-m}<\eta_{0}\) and show the statement with \(q=m n\). Given \((a, b), E\) and \(J_{k}(t)\), use Lemma 1.6 with these \(m, n, \eta=\frac{1}{2}\) and \(\sigma=2\) to find a disjoint \(\mathcal{I} \subset\left\{J_{k}(t): t \in E, k=0, \ldots, q\right\}\) such that for every \(t \in E\) at least one of the statements 1.6(i), 1.6(ii) holds for the intervals \(J_{0}(t), \ldots, J_{q}(t)\).

For any interval \(I \in \mathcal{I}\) denote \(\hat{I}=\{t: \operatorname{dist}(t, I) \leq 2|I|\}\) and let \(A\) be the set of \(t\) for which there are disjoint intervals \(I_{0}, \ldots, I_{n} \in \mathcal{I}\) such that \(t \in \hat{I}_{k}\) for every \(k=0, \ldots, n\). Then \((n+1) \mathbf{1}_{A} \leq \sum_{I \in \mathcal{I}} \mathbf{1}_{\hat{I}}\) and integrating this inequality gives \((n+1)|A| \leq \sum_{I \in \mathcal{I}}|\hat{I}| \leq 5 \sum_{I \in \mathcal{I}}|I| \leq 5(b-a)\). Hence \(|A|<\frac{1}{2} \eta_{0}(b-a)\).

Also let \(B=\left\{t: \max (\operatorname{dist}(t, I), \operatorname{dist}(t, \mathbb{R} \backslash I)) \leq \frac{1}{8} \eta_{0}|I|\right.\) for some \(\left.I \in \mathcal{I}\right\}\) and observe that \(|B| \leq \frac{1}{2} \eta_{0} \sum_{I \in \mathcal{I}}|I| \leq \frac{1}{2} \eta_{0}(b-a)\).

If \(J_{q}(t)\) is not contained in \(\bigcup \mathcal{I}\), the sequence \(J_{0}(t), \ldots, J_{m n}(t)\) either satisfies 1.6(i), and we infer \(J_{q}(t) \subset A\), or it satisfies \(1.6(\mathrm{ii})\), in which case \(J_{q}(t) \subset B\). Hence the measure of the union of these intervals is less than \(\eta_{0}(b-a)\).

Directional porosity. We now introduce a simple but important class of \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-null sets, although we prove that they are indeed \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-null only in Lemma 2.2 . A subset \(P\) of a Banach space \(X\) is said to be porous at a point \(x \in P\) in the direction of \(e \in X\) if \(\lim \sup _{t \rightarrow 0} \operatorname{dist}(x+t e, P) /|t|>0\). A point \(x \in P\) for which such an \(e\) exists is termed a point of directional porosity of \(P\). Sets whose every point is a point of directional porosity are called directionally porous, and \(\sigma\)-directionally porous sets are defined as countable unions of directionally porous ones. The set \(P\) is said to be porous in the direction of \(e\) if it is porous in the direction of \(e\) at each of its points. In separable spaces, every \(\sigma\)-directionally porous set can be written as the union of countably many sets \(E_{i}\) each of which is porous in the direction of some \(e_{i}\). We also remark that directionally porous sets are often defined in a more geometric way, but since we do not need it, we just give the following simple fact showing, in particular, that the set of points of a set \(E\) at which the Hadamard derivative of \(f: E \rightarrow Y\) is not determined uniquely is directionally porous.

Lemma 1.8: If \(E\) is not directionally porous at \(x\), for every \(u \in X\) and \(t_{k} \searrow 0\) there are \(u_{k} \rightarrow u\) such that \(x+t_{k} u_{k} \in E\).

Proof. Choose \(x_{k} \in E\) such that \(\left\|x_{k}-\left(x+t_{k} u\right)\right\|<t_{k}^{2}+\operatorname{dist}\left(x_{k}+t_{k} u, E\right)\) and define \(u_{k}=\left(x_{k}-x\right) / t_{k}\).

In our context, the importance of the concept of directional porosity stems from two facts. Firstly, directionally porous sets are Gâteaux nondifferentiability sets of real-valued Lipschitz functions: it is easy to see that porosity of \(P\) at \(x_{0} \in P\) in the direction of \(e\) is equivalent to non-existence of \(f^{\prime}\left(x_{0} ; e\right)\) where \(f(x)=\operatorname{dist}(x, P)\). Secondly, many results show that sets of points of nondifferentiability at which the function behaves too wildly tend to be \(\sigma\)-directionally porous. (See, for example, \([6,16,23,24,25]\).) Together with the first observation, this reduces the proof that a given \(\sigma\)-ideal contains nondifferentiability sets to showing that it contains directionally porous sets and sets of nondifferentiability points in which the behaviour of the function is suitably regular. The following three lemmas are variants of special cases of Zajíček's observation [24, 25] that many results on \(\sigma\)-directional porosity of exceptional sets of

Lipschitz functions hold for pointwise Lipschitz functions. The first reduces differentiability questions for maps from separable spaces to maps with separable targets.

Lemma 1.9: Let \(f\) map a subset \(E\) of a separable Banach space \(X\) to a metric space \(M\). Then there are \(g: E \rightarrow M\) with separable range and a \(\sigma\)-directionally porous set \(P \subset X\) such that \(g(x)=f(x), \operatorname{Lip}_{x}(g, E)<\infty\) and

\[
\lim _{k \rightarrow \infty} \frac{d\left(f\left(x+t_{k} u_{k}\right), g\left(x+t_{k} u_{k}\right)\right)}{t_{k}}=0
\]

whenever \(x \in E \backslash P, \operatorname{Lip}_{x}(f, E)<\infty, u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\).\\
Proof. Let \(F=\left\{x \in E: \operatorname{Lip}_{x}(f, E)<\infty\right\}\) and define \(g: E \rightarrow M\) so that \(g(x)=f(x)\) when \(\operatorname{dist}(f(x), f(F))=0\) and \(g(x) \in f(F) \cap B(f(x), 2 r)\) when \(\operatorname{dist}(f(x), f(F))=r>0\). Then for every \(x \in F, g(x)=f(x)\) and \(\operatorname{Lip}_{x}(g, E) \leq\) \(2 \operatorname{Lip}_{x}(f, E)\) since \(g(y) \neq f(y)\) implies \(g(y)=g(z)\) for some \(z \in B(x, 2\|y-x\|)\). Moreover, the range of \(g\) is contained in the closure of \(f(F)\) which is separable since the restriction of \(f\) to \(F\) is continuous.

Let \(P=\bigcup_{n=1}^{\infty} P_{n}\) where \(P_{n}\) is the set of directional porosity points of

\[
F_{n}:=\{x \in F: \operatorname{dist}(f(y), f(x)) \leq n\|y-x\| \text { for } y \in E \text { with }\|y-x\|<1 / n\} .
\]

Suppose \(x \in F \backslash P, u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\). Find \(n\) so that \(x \in F_{n}\) and use \(x \notin P_{n}\) to find \(x_{k} \in F_{n}\) such that \(d_{k}:=\left\|x+t_{k} u-x_{k}\right\|=o\left(t_{k}\right)\). Then \(f\left(x_{k}\right)=g\left(x_{k}\right)\), and hence for large enough \(k, \operatorname{dist}\left(f\left(x+t_{k} u_{k}\right), g\left(x+t_{k} u_{k}\right)\right)\) is bounded by \(\operatorname{dist}\left(f\left(x+t_{k} u_{k}\right), f\left(x_{k}\right)\right)+\operatorname{dist}\left(g\left(x+t_{k} u_{k}\right), g\left(x_{k}\right)\right) \leq 3 n d_{k}\).

The next Lemma reduces differentiability properties of a sequence of realvalued functions at points at which it is equi-Lipschitz to differentiability properties of sequences of equi-Lipschitz functions.

Lemma 1.10: Let \(h_{1}, h_{2}, \ldots\) be real-valued functions on a subset \(E\) of a separable Banach space \(X\). Then there are \(g_{i, j}: X \rightarrow \mathbb{R}\) and a \(\sigma\)-directionally porous set \(P \subset X\) such that \(\operatorname{Lip}\left(g_{i, j}\right) \leq 1\) and for every \(x \in E \backslash P\) satisfying

\[
\limsup _{E \ni y \rightarrow x} \sup _{i \in \mathbb{N}} \frac{\left|h_{i}(y)-h_{i}(x)\right|}{\|y-x\|}<\infty
\]

there are \(\kappa(x) \geq 0\) and \(j(x) \in \mathbb{N}\) such that

\[
\lim _{k \rightarrow \infty} \sup _{i \in \mathbb{N}}\left|\frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)}{t_{k}}-\kappa(x) \frac{g_{i, j(x)}\left(x+t_{k} u\right)-g_{i, j(x)}(x)}{t_{k}}\right|=0
\]

whenever \(u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\).\\
Proof. Let

\[
F_{m}:=\left\{x \in E: \sup _{i \in \mathbb{N}}\left|h_{i}(y)-h_{i}(x)\right| \leq m\|y-x\| \text { for } y \in E \text { with }\|y-x\|<\frac{1}{m}\right\}
\]

and write each \(F_{n}\) as \(\bigcup_{n=1}^{\infty} F_{m, n}\) where \(\operatorname{diam}\left(F_{m, n}\right)<\frac{1}{m}\). For each \(i, m, n\) the restriction of \(\frac{1}{m} h_{i}\) to \(F_{m, n}\) can be extended to a function \(h_{i, m, n}: X \rightarrow \mathbb{R}\) with \(\operatorname{Lip}\left(h_{i, m, n}\right) \leq 1\). Define the \(g_{i, j}\) by ordering the pairs ( \(m, n\) ) into a sequence \(\left(m_{j}, n_{j}\right)\) and letting \(g_{i, j}=h_{i, m_{j}, n_{j}}\).

Let \(P=\bigcup_{m=1}^{\infty} \bigcup_{n=1}^{\infty} P_{m, n}\) where \(P_{m, n}\) is the set of points of directional porosity of \(F_{m, n}\). Suppose \(x \in E \backslash P\) satisfies (2), \(u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\). Then \(x \in F_{m, n} \backslash P_{m, n}\) for some \(m, n\) and so there are \(x_{k} \in F_{m, n}\) such that \(d_{k}:=\left\|x+t_{k} u-x_{k}\right\|=o\left(t_{k}\right)\). Then \(h_{i}(x)=m h_{i, m, n}(x)\), \(h_{i}\left(x_{k}\right)=m h_{i, m, n}\left(x_{k}\right)\), and hence for large enough \(k\),

\[
\sup _{i \in \mathbb{N}}\left|\left(h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)\right)-m\left(h_{i, m, n}\left(x+t_{k} u\right)-h_{i, m, n}(x)\right)\right| \leq 2 m d_{k}
\]

Hence (3) holds with \(\kappa(x)=m\) and \(j(x)\) such that \((m, n)=\left(m_{j(x)}, n_{j(x)}\right)\).\\
The next Lemma shows sublinearity of upper derivatives of sequences of realvalued functions. We will use it to prove Theorem 2.9 that allows extension of differentiability results to vector-valued functions.

Lemma 1.11: Let \(h_{1}, h_{2}, \ldots\) be real-valued functions on a separable Banach space \(X\) with \(\operatorname{Lip}\left(h_{i}\right) \leq 1\). Then there is a \(\sigma\)-directionally porous set \(P \subset X\) such that whenever \(x \in X \backslash P, u_{k}, v_{k}, u, v \in X, u_{k} \rightarrow u, v_{k} \rightarrow v\) and \(t_{k} \searrow 0\),

\[
\limsup _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}} \leq \limsup _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t(u-v))-h_{i}(x)}{t}
\]

and

\[
\liminf _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}} \geq \liminf _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t(u-v))-h_{i}(x)}{t}
\]

Proof. Let \(D\) be a countable dense subset of \(\mathcal{S}_{X}\). Given \(w \in D\) and rational \(\alpha<\beta\) and \(\eta>0\) let

\[
E_{w, \alpha, \beta, \eta}=\left\{x: \alpha<\sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}<\beta \text { for } 0<t<\eta\right\}
\]

Let \(P_{w, \alpha, \beta, \eta}\) be the set of directional porosity points of \(E_{w, \alpha, \beta, \eta}\) and define \(P=\bigcup_{w, \alpha, \beta, \eta} P_{w, \alpha, \beta, \eta}\). Given \(x \in X \backslash P\) and \(\varepsilon>0\), find first \(w \in D\) with \(\|u-v-w\|<\frac{1}{2} \varepsilon\), then rational \(\alpha, \beta\) such that

\[
\begin{aligned}
& \liminf _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}>\alpha>\liminf _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}-\frac{1}{2} \varepsilon, \\
& \limsup _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}<\beta<\limsup _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}+\frac{1}{2} \varepsilon,
\end{aligned}
\]

and finally rational \(\eta>0\) such that \(x \in E_{w, \alpha, \beta, \eta}\). Suppose \(u_{k}, v_{k}, u, v \in X\), \(u_{k} \rightarrow u, v_{k} \rightarrow v\) and \(t_{k} \searrow 0\). Let \(r_{k}=\operatorname{dist}\left(x+t_{k} v_{k}, E_{w, \alpha, \beta, \varepsilon}\right)+t_{k}^{2}\), choose \(x_{k} \in E_{w, \alpha, \beta, \eta} \cap B\left(x+t_{k} v_{k}, r_{k}\right)\) and for large enough \(k\) estimate

\[
\begin{aligned}
& h_{i}(x\left.+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right) \\
& \leq h_{i}\left(x_{k}+t_{k} w\right)-h_{i}\left(x_{k}\right)+\left\|x+t_{k} u_{k}-\left(x_{k}+t_{k} w\right)\right\|+\left\|x+t_{k} v_{k}-x_{k}\right\| \\
& \quad \leq \beta t_{k}+\left\|u_{k}-v_{k}-w\right\| t_{k}+2 r_{k} .
\end{aligned}
\]

Since \(r_{k}=o\left(t_{k}\right)\), we infer that

\[
\begin{aligned}
\limsup _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}} & \leq \beta+\|u-v-w\| \\
& <\limsup _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}+\varepsilon
\end{aligned}
\]

and, similarly,

\[
\liminf _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}}>\liminf _{t \searrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i}(x+t w)-h_{i}(x)}{t}-\varepsilon
\]

Since \(\varepsilon>0\) is arbitrary, the statement follows.\\
For completeness, we also prove the following lemma.\\[0pt]
Lemma 1.12 ([25, Proposition 3.1]): For every map \(f\) of an open subset \(G\) of a separable Banach space \(X\) to a Banach space \(Y\) there is a \(\sigma\)-directionally porous set \(P \subset G\) such that for every \(x \in X \backslash P\) either \(\operatorname{Lip}_{x}(f)<\infty\) or

\[
\limsup _{C \ni u \rightarrow 0} \frac{\|f(x+u)-f(x)\|}{\|u\|}=\infty
\]

for every cone \(C\) in \(X\).\\
Proof. The set of \(x\) 's which fail (4) is a countable union of sets \(E\) for which there are \(e \in X\) with \(\|e\|=1\) and \(0<c, \delta, \tau<\infty\) such that \(\|f(x+u)-f(x)\| \leq c\|u\|\) whenever \(x \in E, u \in C(e, \tau) \cap B(0, \delta)\). Hence it suffices to show \(\operatorname{Lip}_{x}(f)<\infty\)\\
for every \(x \in E\) that does not belong to the set \(P\) of points of porosity of \(E\) in the direction of \(e\).

Given \(x_{0} \in E \backslash P\), find \(0<\sigma<\delta\) so that \(\operatorname{dist}\left(x_{0}+t e, E\right)<\frac{1}{2} \tau|t|\) for \(|t|<\sigma\). If \(0<\left\|x-x_{0}\right\|<\sigma /(2+2 / \tau)\), we let \(t=2\left\|x-x_{0}\right\| / \tau\) and find \(z \in E\) such that \(\left\|z-\left(x_{0}-t e\right)\right\|<\frac{1}{2} \tau|t|\). Then \(\left\|\left(x_{0}-z\right)-t e\right\|<\tau|t|\), hence \(x_{0}-z \in C\) and \(\|x-z-t e\| \leq\left\|x-x_{0}\right\|+\left\|z-\left(x_{0}-t e\right)\right\|<\tau t\), hence \(x-z \in C\). Noticing that \(\left\|x_{0}-z\right\| \leq(1+2 / \tau)\left\|x-x_{0}\right\|\) and \(\|x-z\| \leq(2+2 / \tau)\left\|x-x_{0}\right\|\) and that both these estimates are \(<\delta\), we conclude

\[
\left\|f(x)-f\left(x_{0}\right)\right\| \leq\|f(x)-f(z)\|+\left\|f\left(x_{0}\right)-f(z)\right\| \leq(3+4 / \tau) c\left\|x-x_{0}\right\| .
\]

\section*{2. Differentiability of (sequences of) real-valued functions}
Here we first give a relatively simple proof of differentiability of real-valued Lipschitz functions, as a corollary of which we obtain that \(\sigma\)-directionally porous sets are \(\mathcal{\mathcal { C }}\)-null. These results suffice for all we show about differentiability of real-valued functions, in particular for the proof that \(\mathcal{C}\) is the \(\sigma\)-ideal generated by the sets of nondifferentiability of cone-monotone functions in Section 3. For the vector-valued case treated in Section 4 we, however, need a more delicate result essentially showing weak \({ }^{\star}\) differentiability of \(\ell_{\infty}\) valued functions, which we prove in the second part of this Section.

Lemma 2.1: Suppose \(g\) is a real-valued Lipschitz function on a Banach space \(X\) and \(e \in X\). Then \(g^{\prime}(x ; e)\) exists for \(\stackrel{\mathcal{C}}{ }\)-almost every \(x \in X\).

Proof. It suffices to assume \(\operatorname{Lip}(g) \leq 1\) and \(\|e\|=1\), fix \(-1<\alpha<\beta<1\), choose \(0<\sigma<1\) such that \(|g(\gamma(s+t))-g(\gamma(s)+t e)| \leq \frac{1}{3}(\beta-\alpha)\) for every \(\gamma \in \Gamma_{C(e, \sigma)}\) and \(s, t \in \mathbb{R}\), and show that the set

\[
N:=\left\{x \in X: \liminf _{t \rightarrow 0} \frac{g(x+t e)-g(x)}{t}<\alpha, \limsup _{t \rightarrow 0} \frac{g(x+t e)-g(x)}{t}>\beta\right\}
\]

is regularly null in the direction of \(C=C(e, \sigma)\).\\
Let \(\alpha_{0}=\frac{2}{3} \alpha+\frac{1}{3} \beta, \beta_{0}=\frac{1}{3} \alpha+\frac{2}{3} \beta\) and choose \(0<\eta<1\) such that \(\left(2+\alpha_{0}\right)<\) \((1-\eta)\left(2+\beta_{0}\right)\) and \(\left(2-\alpha_{0}\right)<(1-\eta)\left(2-\beta_{0}\right)\). Given \(\varepsilon>0\), find \(p \in \mathbb{N}\) and \(\eta_{0}>0\) such that \((1-\eta)^{p}+3 \eta_{0}(p+1)<\varepsilon\), and for this \(\eta_{0}\) find \(q \in \mathbb{N}\) such that the covering statement of Lemma 1.7 holds.\\
Let \(G\) be the set of \(x \in X\) for which there are \(0<u_{i}^{-}, v_{i}^{-}, u_{i}^{+}, v_{i}^{+}<1\), \(i=0,1, \ldots,(p+1)(q+1)\) with \(\max \left(u_{i}^{-}, v_{i}^{-}, u_{i}^{+}, v_{i}^{+}\right)<\frac{1}{2} \min \left(u_{i-1}^{-}, v_{i-1}^{-}, u_{i-1}^{+}, v_{i-1}^{+}\right)\),\\
\(g\left(x+v_{i}^{-} e\right)-g\left(x-u_{i}^{-} e\right)<\alpha\left(u_{i}^{-}+v_{i}^{-}\right)\)and \(g\left(x+v_{i}^{+} e\right)-g\left(x-u_{i}^{+} e\right)>\beta\left(u_{i}^{+}+v_{i}^{+}\right)\). Clearly, \(G\) is open and \(N \subset G\).

Let \(\gamma \in \Gamma_{C}, \varphi:=g \circ \gamma\) and \(E:=\gamma^{-1}(G) \cap(0,1)\). Then \(\operatorname{Lip}(\varphi) \leq 2\), \(\varphi\left(t+v_{i}^{-}\right)-\varphi\left(t-u_{i}^{-}\right)<\alpha_{0}\left(u_{i}^{-}+v_{i}^{-}\right)\)and \(\varphi\left(t+v_{i}^{+}\right)-\varphi\left(t-u_{i}^{+}\right)>\beta_{0}\left(u_{i}^{+}+v_{i}^{+}\right)\) for every \(t \in E\).

For \(n=0, \ldots, p, k=0, \ldots, q\) and \(t \in E\) let

\[
J_{k}^{n}(t)= \begin{cases}\left(t-u_{i}^{-}, t+v_{i}^{-}\right) & \text {if } n \text { is even } \\ \left(t-u_{i}^{+}, t+v_{i}^{+}\right) & \text {if } n \text { is odd }\end{cases}
\]

where \(i=k+n(q+1)\). By Lemma 1.7, for each \(n=0, \ldots, p\) choose a finite disjoint subcollection \(\mathcal{I}_{n}\) of \(\left\{J_{k}^{n}(t): k=0, \ldots, q, t \in E\right\}\) such that the set

\[
E_{n}:=\bigcup\left\{J_{q}^{n}(t): J_{q}^{n}(t) \text { is not contained in an interval from } \mathcal{I}_{n}\right\}
\]

satisfies \(\left|E_{n}\right|<3 \eta_{0}\). Recursively define \(\tilde{\mathcal{I}}_{0}=\mathcal{I}_{0}\) and \(\tilde{\mathcal{I}}_{n+1}\) as the collection of \(I \in \mathcal{I}_{n+1}\) that are contained in an interval from \(\tilde{\mathcal{I}}_{n}\). Let \(U_{n}\) be the union of intervals from \(\tilde{\mathcal{I}}_{n}\).

We show \(E \backslash U_{p} \subset \bigcup_{n=0}^{p} E_{n}\). For this, suppose \(t \in E \backslash\left(U_{p} \cup \bigcup_{n=0}^{p} E_{n}\right)\) and find the least \(k\) with \(t \notin U_{k}\). Since \(t \notin E_{0}, k>0\) and since \(t \notin E_{k}\), there is \(J=J_{j}^{k}(s) \in \mathcal{I}_{k}\) with \(t \in J\). Using \(t \in U_{k-1}\), we find \(I \in \tilde{\mathcal{I}}_{k-1}\) such that \(t \in I\). Since \(J \not \subset I\) and \(J \subset J_{q}^{k-1}(s)\), we infer \(t \in J_{q}^{k-1}(s) \subset E_{k-1}\), a contradiction.

When \(I=(a, b) \in \tilde{\mathcal{I}}_{n}\) where \(n<p\) is even,

\[
\alpha_{0}|I| \geq \varphi(b)-\varphi(a) \geq \beta_{0}\left|I \cap U_{n+1}\right|-2\left(|I|-\left|I \cap U_{n+1}\right|\right)
\]

showing that \(\left|U_{n+1}\right| \leq\left(\alpha_{0}+2\right)\left|U_{n}\right| /\left(\beta_{0}+2\right) \leq(1-\eta)\left|U_{n}\right|\). A symmetric argument shows that \(\left|U_{n+1}\right| \leq(1-\eta)\left|U_{n}\right|\) also for odd \(n<p\). Hence

\[
|E| \leq\left|U_{p}\right|+\sum_{n=0}^{p}\left|E_{n}\right| \leq(1-\eta)^{p}+3 \eta_{0}(p+1)<\varepsilon
\]

Basic results on smallness of directionally porous sets and differentiability of Lipschitz functions follow easily from Lemma 2.1.

Lemma 2.2: Every \(\sigma\)-directionally porous subset of a separable Banach space is \(\stackrel{\mathcal{C}}{ }\)-null.

Proof. If \(E\) is porous in the direction of \(e\), the derivative \(g^{\prime}(x ; e)\) of the function \(g(x):=\operatorname{dist}(x, E)\) fails to exist for any \(x \in E\).

Proposition 2.3: Every real-valued function on a separable Banach space is Gâteaux differentiable at \(\stackrel{\Im}{\mathcal{C}}\)-almost every point at which it is Lipschitz.

Proof. By Lemma 1.10 it suffices to consider the case of a Lipschitz function \(g\). Then Lemma 2.1 implies that for \(\mathscr{\mathcal { C }}\)-almost every \(x\) the derivative \(g^{\prime}(x ; e)\) exists for a dense set of directions \(e\). Hence [23, Theorem 2] (or Lemma 1.11 with all \(h_{i}\) equal to \(g\) ) and Lemma 2.2 imply that \(g\) is Gâteaux differentiable \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-almost everywhere.

We now come to results that will be needed to study the vector-valued case in Section 4. In the following four lemmas, which prepare the ground for the key Lemma 2.8, we will show that for an equi-Lipschitz sequence of functions there is certain uniformity in the way their slopes converge to their derivatives. In order not to repeat their main assumptions, we specify the object of our study for all of them at one go.

Assumptions for Lemmas 2.4-2.7: We suppose that \(X\) is a separable Banach space, \(e \in X\) is a unit vector and \(g_{0}, g_{1}, \ldots: X \rightarrow \mathbb{R}\) satisfy \(\operatorname{Lip}\left(g_{i}\right) \leq 1\).

Lemma 2.4: For every \(\alpha \in \mathbb{R}, q \in \mathbb{N}\) and lower semicontinuous \(\xi: X \rightarrow[0, \infty)\) there is a lower semicontinuous \(0 \leq \zeta \leq \xi\) such that\\
(a) \(\zeta(x)>0\) whenever \(\xi(x)>0\) and \(\liminf _{t \rightarrow 0} \inf _{m \in \mathbb{N}} \frac{g_{m}(x+t e)-g_{m}(x)}{t}<\alpha\);\\
(b) if \(\zeta(x)>0\) then for every \(i=0, \ldots, q\) there are \(\zeta(x)<u_{i}, v_{i}<\xi(x)\) and \(m \in \mathbb{N}\) such that \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) and

\[
g_{m}\left(x+v_{i} e\right)-g_{m}\left(x-u_{i} e\right)<\alpha\left(u_{i}+v_{i}\right)
\]

Proof. It suffices to treat the special case \(q=0\), since the general case follows by repeating its use with \(\xi\) replaced by \(\frac{1}{2} \zeta\) where \(\zeta\) was obtained in the previous step. For \(x \in X\) and \(r>0\) denote

\[
h(x, r)=\inf _{m \in \mathbb{N}} \inf \left\{\frac{g_{m}(x+v e)-g_{m}(x-u e)}{u+v}: r<u, v<\xi(x)\right\}
\]

We show that the set

\[
G:=\{(x, r) \in X \times(0, \infty): 0<r<\xi(x), h(x, r)<\alpha\}
\]

is open. Supose \((x, r) \in G\) and find \(r<u, v<\xi(x)\) and \(m \in \mathbb{N}\) such that \(g_{m}(x+v e)-g_{m}(x-u e)<\alpha(u+v)\). Let \(\varepsilon>0\) be such that \(r+\varepsilon<u, v<\xi(x)-\varepsilon\) and \(g_{m}(x+v e)-g_{m}(x-u e)<\alpha(u+v)-2 \varepsilon\). By semicontinuity of \(\xi\), find\\
\(0<\delta<\varepsilon\) such that \(\xi(y)>\xi(x)-\varepsilon\) for every \(y \in B(x, \delta)\). Then for every \(y \in B(x, \delta), r+\varepsilon<u, v<\xi(y)\), and

\[
g_{m}(y+v e)-g_{m}(y-u e) \leq g_{m}(x+v e)-g_{m}(x+u e)+2 \varepsilon<\alpha(u+v)
\]

Consequently, \(B(x, \delta) \times(0, r+\varepsilon) \subset G\), and so \(G\) is open.\\
Let \(H\) be the first projection of \(G\). For any \(x\) satisfying the conditions of (a) there is \(0<|t|<\xi(x)\) and \(m \in \mathbb{N}\) such that \(\left(g_{m}(x+t e)-g_{m}(x)\right) / t<\alpha\). If \(t<0\), letting \(u=-t\) and choosing \(0<v<t\) small enough shows \(x \in H\); if \(t>0\), a symmetric argument gives the same conclusion. Hence, letting \(\zeta(x)=\frac{1}{4} \sup \{r:(x, r) \in G\}\) for \(x \in H\) and \(\zeta(x)=0\) for \(x \notin H\) defines a lower semicontinuous function for which both (a) and (b) hold.

Lemma 2.5: For every \(\beta \in \mathbb{R}, q \in \mathbb{N}\), lower semicontinuous \(\xi: X \rightarrow[0, \infty)\) and upper semicontinuous \(\omega: X \rightarrow \mathbb{N} \cup\{\infty\}\) there is a lower semicontinuous \(0 \leq \zeta \leq \xi\) such that\\
(a) \(\zeta(x)>0\) whenever \(\xi(x)>0, \omega(x)<\infty\) and \(_{\inf }^{j \leq \omega(x)}{ }_{D} g_{j}(x ; e)>\beta\);\\
(b) if \(\zeta(x)>0\) then for every \(i=0, \ldots, q\) and \(j=0, \ldots, \omega(x)\) there are \(\zeta(x)<u_{i}, v_{i}<\xi(x)\) with \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) for \(i \geq 1\) and

\[
g_{j}\left(x+v_{i} e\right)-g_{j}\left(x-u_{i} e\right)>\beta\left(u_{i}+v_{i}\right)
\]

Proof. As in the previous lemma, it suffices to treat the special case \(q=0\). For \(s>0\) and \(x \in X\) with \(\xi(x)>0\) and \(\omega(x)<\infty\) denote

\[
h(x, s)=\inf _{j \leq \omega(x)} \sup \left\{\frac{g_{j}(x+v e)-g_{j}(x-u e)}{u+v}: 0<s<u, v<\xi(x)\right\}
\]

We show that the set

\[
G:=\{(x, s) \in X \times(0, \infty): 0<s<\xi(x), \omega(x)<\infty, h(x, s)>\beta\}
\]

is open. Suppose \((x, s) \in G\) and for each \(j=0, \ldots, \omega(x)\) find \(s<u_{j}, v_{j}<\xi(x)\) such that \(g_{j}\left(x+v_{j} e\right)-g_{j}\left(x+u_{j} e\right)>\beta\left(u_{j}+v_{j}\right)\). Let \(\varepsilon>0\) be such that for each \(j=0, \ldots, \omega(x), s+\varepsilon<u_{j}, v_{j}<\xi(x)-\varepsilon\) and

\[
g_{j}\left(x+v_{j} e\right)-g_{j}\left(x+u_{j} e\right)>\beta\left(u_{j}+v_{j}\right)+2 \varepsilon
\]

By semicontinuity, find \(0<\delta<\varepsilon\) such that \(\xi(y)>\xi(x)-\varepsilon\) and \(\omega(y) \leq \omega(x)\) for every \(y \in B(x, \delta)\). Then for every \(y \in B(x, \delta)\) and \(j=0, \ldots, \omega(y)\) we have \(j \leq \omega(x)\) and so \(s+\varepsilon<u_{j}, v_{j}<\xi(y)\) and

\[
g_{j}\left(y+v_{j} e\right)-g_{j}\left(y-u_{j} e\right) \geq g_{j}\left(x+v_{j} e\right)-g_{j}\left(x-u_{j} e\right)-2 \varepsilon>\beta\left(u_{j}+v_{j}\right)
\]

It follows that \(B(x, \delta) \times(0, s+\varepsilon) \subset G\), and so \(G\) is open.\\
Let \(H\) be the first projection of \(G\). For any \(x\) satisfying the conditions of (a) we have \(0<\left|t_{j}\right|<\xi(x), j=0, \ldots, \omega(x)\) such that \(\left(g_{j}\left(x+t_{j} e\right)-g_{j}(x)\right) / t_{j}>\beta\), and the same argument as in the proof of the previous lemma may be used for each \(j\) to conclude that \(h(x, s)>\beta\) for small enough \(s>0\). Hence, letting \(\zeta(x)=\frac{1}{4} \sup \{s:(x, s) \in G\}\) for \(x \in H\) and \(\zeta(x)=0\) for \(x \notin H\) defines a lower semicontinuous function for which both (a) and (b) hold.

Lemma 2.6: For every lower semicontinuous \(\xi: X \rightarrow[0,1]\) there is an upper semicontinuous \(\omega: X \rightarrow \mathbb{N} \cup\{\infty\}\) such that for every \(x \in X\),\\
(a) \(\omega(x)<\infty\) if and only if \(\xi(x)>0\);\\
(b) if \(\xi(x)>0, j \in \mathbb{N}\) and \(|t| \leq 1\), there is \(i \leq \omega(x)\) such that

\[
g_{j}(x+t e)-\xi(x)<g_{i}(x+t e)<g_{j}(x+t e)+\xi(x)
\]

Proof. Define \(g_{j}^{x} \in C[-1,1]\), where \(C[-1,1]\) is the space of continuous functions on \([-1,1]\) equipped with the maximum norm, by \(g_{j}^{x}(t)=g_{j}(x+t e)-g_{j}(x)\). Let \(\omega(x)=\infty\) if \(\zeta(x)=0\) and for \(x\) with \(\xi(x)>0\) define

\[
\omega(x)=\min \left\{k \in \mathbb{N}: \sup _{j \in \mathbb{N}} \inf _{i<k}\left\|g_{i}^{x}-g_{j}^{x}\right\|<\xi(x)\right\}
\]

Since the functions \(g_{j}^{x}, j \in \mathbb{N}\), belong to a compact subset of \(C[-1,1]\), \(\omega\) is well-defined. To show its lower semicontinuity, find \(\varepsilon>0\) such that \(\sup _{j \in \mathbb{N}} \inf _{i<\omega(x)}\left\|g_{i}^{x}-g_{j}^{x}\right\|<\xi(x)-4 \varepsilon\) and by lower semicontinuity of \(\xi\) find \(0<\delta<\varepsilon\) such that \(\xi(y)>\xi(x)-\varepsilon\) for \(y \in B(x, \delta)\). For every \(j \in \mathbb{N}\) there is \(i \leq \omega(x)\) such that \(\left\|g_{i}^{x}-g_{j}^{x}\right\|<\xi(x)-4 \varepsilon\), and for this \(i\) we have

\[
\left\|g_{i}^{y}-g_{j}^{y}\right\| \leq\left\|g_{i}^{x}-g_{j}^{x}\right\|+2 \delta<\xi(x)-2 \varepsilon \leq \xi(y)-\varepsilon
\]

for \(\|y-x\|<\delta\). Hence \(\omega(y) \leq \omega(x)\) for these \(y\), as required.\\
We are ready to state and prove the final technical lemma of this series.\\
Lemma 2.7: Given \(-1<\alpha<\beta<1\), let

Then \(N\) is regularly null in the direction of \(C(e, \sigma)\) for any \(0<\sigma<\frac{1}{6}(\beta-\alpha)\).

Proof. Find \(\kappa>0\) so that \(\eta:=\frac{1}{2}(\beta-\alpha-6 \sigma-2 \kappa)>0\). Given \(0<\varepsilon<1\), find \(p \in \mathbb{N}\) so that \((1-\eta)^{p}<\varepsilon\) and then find \(\eta_{0}>0\) so that \((1-\eta)^{p}+2(p+1) \eta_{0}<\varepsilon\). For this \(\eta_{0}\) find \(q \in \mathbb{N}\) for which the covering statement of Lemma 1.7 holds.

Denote by \(\mathcal{D}\) the set of \([0,1]\)-valued lower semicontinuous functions on \(X\) that are strictly positive on \(N\) and by \(\mathcal{P}\) the set of \(\mathbb{N} \cup\{\infty\}\)-valued upper semicontinuous functions on \(X\) that are finite on \(N\). We let \(\zeta_{0}(x)=\eta_{0}\) and recursively define functions \(\zeta_{n} \in \mathcal{D}, n=1, \ldots, 2 p\), and, for odd \(n\), also \(\omega_{n} \in \mathcal{P}\). For this, we assume \(\zeta_{n-1} \in \mathcal{D}\) has been already defined and proceed as follows.

CASE \(n\) ODD: First define \(\zeta_{n}\) by using Lemma 2.4 with \(\xi=\zeta_{n-1}\). Hence \(\zeta_{n} \leq \zeta_{n-1}, \zeta_{n} \in \mathcal{D}\) and for every \(x\) with \(\zeta_{n}(x)>0\) and \(i=0, \ldots, q\) there are \(\zeta(x)<u_{i}, v_{i}<\xi(x)\) and \(m \in \mathbb{N}\) such that \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) and \(g_{m}\left(x+v_{i} e\right)-g_{m}\left(x-u_{i} e\right)<\alpha\left(u_{i}+v_{i}\right)\).

Then use Lemma 2.6 to find \(\omega_{n} \in \mathcal{P}\) such that whenever \(\zeta_{n}(x)>0\) then \(\omega_{n}(x)<\infty\) and for every \(j \in \mathbb{N}\) and \(|t| \leq 1\) there is \(i \leq \omega_{n}(x)\) such that

\[
g_{j}(x+t e)-\kappa \zeta_{n}(x) \leq g_{i}(x+t e) \leq g_{j}(x+t e)+\kappa \zeta_{n}(x)
\]

Case \(n\) EVEN: Define \(\zeta_{n}\) by Lemma 2.5 with \(\xi=\zeta_{n-1}\). Hence \(\zeta_{n} \leq \zeta_{n-1}\), \(\zeta_{n} \in \mathcal{D}\) and for every \(x\) with \(\zeta_{n}(x)>0, i=0, \ldots, q\) and \(j=0, \ldots, \omega_{n-1}(x)\) we may find \(\zeta_{n}(x)<u_{i}, v_{i}<\zeta_{n-1}(x)\) satisfying \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) and \(g_{j}\left(x+v_{i} e\right)-g_{j}\left(x-u_{i} e\right)>\beta\left(u_{i}+v_{i}\right)\).

Having finished this construction, we have an open set \(G:=\left\{x: \zeta_{2 p}(x)>0\right\}\) containing \(N\) and we just need to fix \(\gamma \in C^{1}(\mathbb{R}, X)\) with \(\left\|\gamma^{\prime}-e\right\|<\sigma\) and estimate the measure of \(E:=\gamma^{-1}(G) \cap(0,1)\). For this we denote \(\alpha_{0}=\alpha+2 \kappa+3 \sigma\) and recursively define open sets \(H_{0}, H_{1}, \ldots, H_{2 p} \subset(0,1)\) and measurable sets

\[
E_{n}:=\left\{t \in H_{n} \cap E:\left(t-\zeta_{n}(\gamma(t)), t+\zeta_{n}(\gamma(t))\right) \subset H_{n}\right\}
\]

such that \(H_{0}=(0,1)\) and for \(1 \leq n \leq 2 p\),\\
(a) \(H_{n} \subset H_{n-1}\);\\
(b) \(\left|E_{n-1} \backslash E_{n}\right|<\eta_{0}\);\\
(c) if \(n\) is even, then \(\left|H_{n}\right| \leq(1-\eta)\left|H_{n-1}\right|\);\\
(d) if \(n\) is odd, then for every component \(J=(a, b)\) of \(H_{n}\) with \(J \cap E_{n} \neq \emptyset\) there is \(j \leq \min _{t \in J \cap E_{n}} \omega_{n}(\gamma(t))\) such that \(g_{j}(\gamma(b))-g_{j}(\gamma(a))<\alpha_{0}(b-a)\).

Once this is done, we observe that \(\left|E \backslash E_{0}\right| \leq 2 \eta_{0}\) since \(\zeta_{0}=\eta_{0}\) and that \(\left|H_{2 p}\right| \leq(1-\eta)^{p}\) by (c). Together with (b) this gives the required estimate

\[
|E| \leq\left|H_{2 p} \cup\left(E \backslash E_{0}\right) \cup \bigcup_{n=1}^{2 p}\left(E_{n-1} \backslash E_{n}\right)\right| \leq(1-\eta)^{p}+2 \eta_{0}+2 p \eta_{0}<\varepsilon
\]

Returning to the construction of \(H_{n}\), assume that \(n \geq 1\) and \(H_{n-1}\) and hence also \(E_{n-1}\) have been already defined. Following the definition of \(\zeta_{n}\), also the definition of \(H_{n}\) will depend on parity of \(n\). For odd \(n\) we cover most of \(E_{n-1}\) by intervals on which the increment of some \(g_{j} \circ \gamma\) (where \(j\) depends on the interval) is small, and for even \(n\) we cover it by subintervals of these intervals on which the increment of the same \(g_{j} \circ \gamma\) is large. This discrepancy will be responsible for (c), while Lemma 1.7 will give the estimate (b).

CASE \(n\) ODD: For every \(s \in E_{n-1}\) we define intervals \(J_{i}(s)=\left(s-u_{i}, s+v_{i}\right)\), \(i=0, \ldots, q\), where \(u_{i}, v_{i} \in \mathbb{R}\) are such that \(\zeta_{n}(\gamma(s))<u_{i}, v_{i}<\zeta_{n-1}(\gamma(s))\), \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) and

\[
g_{m}\left(\gamma(s)+v_{i} e\right)-g_{m}\left(\gamma(s)+u_{i} e\right)<\alpha\left(u_{i}+v_{i}\right) \quad \text { for some } m \in \mathbb{N} \text {. }
\]

Let \(\mathcal{I}\) be the disjoint subcollection of \(\left\{J_{i}(s): s \in E_{n-1}, i=0, \ldots, q\right\}\) provided by Lemma 1.7. Letting \(H_{n}=\bigcup \mathcal{I}\), we have (a) by the definition of \(E_{n-1}\) and (b) by Lemma 1.7. We prove that (d) holds for the given component \(J=(a, b)\) of \(H_{n}\) with the least \(j\) such that \(g_{j}(\gamma(a))-g_{j}(\gamma(a))<\alpha_{0}(b-a)\). To show that such a \(j\) exists and has the required property, let \(t \in(a, b) \cap E_{n}\). Since \(J\) is one of the \(J_{i}(s)\), write \(J=\left(s-u_{i}, s+v_{i}\right)\) where \(s, u_{i}, v_{i}\) are as above and find \(m \in \mathbb{N}\) for which the inequality in (5) holds. If \(t \in J \cap E_{n}\), then \(b-a>\zeta_{n}(\gamma(t))\) and hence by definition of \(\omega_{n}\) there is \(j(t) \leq \omega_{n}(\gamma(t))\) such that

\[
\begin{aligned}
g_{j(t)}(\gamma(t)+(b-t) e) & -g_{j(t)}(\gamma(t)-(t-a) e) \\
& \leq g_{m}(\gamma(t)+(b-t) e)-g_{m}(\gamma(t)-(t-a) e)+2 \kappa \zeta_{n}(\gamma(t)) \\
& \leq g_{m}(\gamma(t)+(b-t) e)-g_{m}(\gamma(t)-(t-a) e)+2 \kappa(b-a)
\end{aligned}
\]

This inequality together with the Lipschitz estimates based on

\[
\begin{aligned}
\|(\gamma(t)+(b-t) e)-\gamma(b)\| & \leq \sigma(b-t) \\
\|(\gamma(t)-(t-a) e)-\gamma(a)\| & \leq \sigma(t-a) \\
\left\|(\gamma(t)+(b-t) e)-\left(\gamma(s)+v_{i} e\right)\right\| & =\| \gamma(t)-\gamma(s)-(t-s) e) \| \leq \sigma|s-t| \\
\left\|(\gamma(t)-(t-a) e)-\left(\gamma(s)+u_{i} e\right)\right\| & =\| \gamma(t)-\gamma(s)-(t-s) e) \| \leq \sigma|s-t|
\end{aligned}
\]

give

\[
g_{j(t)}(\gamma(b))-g_{j(t)}(\gamma(a)) \leq g_{m}\left(\gamma(s)+v_{i} e\right)-g_{m}\left(\gamma(s)-u_{i} e\right)+(2 \kappa+3 \sigma)(b-a)
\]

Finally, recalling that \(m\) is such that the inequality in (5) holds, we infer

\[
g_{j(t)}\left(\gamma(b)-g_{j(t)}(\gamma(a))\right)<(\alpha+2 \kappa+3 \sigma)(b-a)=\alpha_{0}(b-a)
\]

and conclude that the required \(j\) exists and satisfies \(j \leq j(t) \leq \omega_{n}(\gamma(t))\) for \(t \in J \cap E_{n}\).

CASE \(n\) EVEN: Consider any component \(J=(a, b)\) of \(H_{n-1}\) with \(J \cap E_{n-1} \neq \emptyset\), and by (d) find \(j \leq \min _{t \in J \cap E_{n-1}} \omega_{n-1}(\gamma(t))\) such that

\[
g_{j}(\gamma(b))-g_{j}(\gamma(a))<\alpha_{0}(b-a)
\]

For \(s \in E_{n-1} \cap(a, b)\) and \(i=0, \ldots, q\) define \(J_{i}(s)=\left(s-u_{i}, s+v_{i}\right)\), where \(\zeta_{n}(\gamma(s))<u_{i}, v_{i}<\zeta_{n-1}(\gamma(s))\) satisfy \(\max \left(u_{i}, v_{i}\right)<\frac{1}{2} \min \left(u_{i-1}, v_{i-1}\right)\) and

\[
g_{j}\left(\gamma(s)+v_{i} e\right)-g_{j}\left(\gamma(s)-u_{i} e\right)>\beta\left(u_{i}+v_{i}\right)
\]

Since \(\operatorname{Lip}\left(g_{j}\right) \leq 1\), this implies

\[
g_{j}\left(\gamma\left(s+v_{i}\right)\right)-g_{j}\left(\gamma\left(s-u_{i}\right)\right)>(\beta-\sigma)\left(u_{i}+v_{i}\right)
\]

Observe also that \(J_{i}(s) \subset\left(s-\zeta_{n-1}(\gamma(s)), s+\zeta_{n-1}(\gamma(s))\right) \subset J\).\\
Let \(\mathcal{I}\) be the disjoint subcollection of \(\left\{J_{i}(s): s \in E_{n-1}, i=0, \ldots, q\right\}\) provided by Lemma 1.7, and denote \(U_{J}=\bigcup \mathcal{I}\). Then \(U_{J} \subset J\) and, as Lemma 1.7 says,

\[
\left|\left\{t \in J \cap E_{n-1}:\left(s-\zeta_{n}(\gamma(s)), s+\zeta_{n}(\gamma(s))\right) \not \subset U_{j}\right\}\right| \leq \eta_{0}|J|
\]

We estimate the measure of \(U_{J}\). For every finite collection \(\mathcal{I}_{0} \subset \mathcal{I}\), we use (6), (7) and \(\operatorname{Lip}\left(g_{j} \circ \gamma\right)<1+\sigma\) to infer

\[
\alpha_{0}|J|>g_{j}(\gamma(b))-g_{j}(\gamma(a)) \geq(\beta-\sigma)\left|\bigcup \mathcal{I}_{0}\right|-(1+\sigma)\left|J \backslash \bigcup \mathcal{I}_{0}\right|
\]

Since \(\mathcal{I}_{0}\) is an arbitrary finite subcollection of \(\mathcal{I}\), we can replace it by the whole \(\mathcal{I}\) and conclude that \((1+\beta-2 \sigma)\left|U_{J}\right| \leq(1+\alpha+2 \kappa+4 \sigma)|J|\). Hence \(\left|U_{J}\right| \leq(1-\eta)|J|\), and because of (8) all our requirements are satisfied by letting \(H_{n}\) be the union of \(U_{J}\) over components \(J\) of \(H_{n-1}\) with \(J \cap E_{n-1} \neq \emptyset\).

The key consequence of Lemma 2.7 is obtained by applying it to a countable dense set of directions.

Lemma 2.8: Let \(g_{i}\) be real-valued functions on a separable Banach space \(X\) such that \(\sup _{i \in \mathbb{N}} \operatorname{Lip}\left(g_{i}\right)<\infty\). Then for \(\stackrel{\mathscr{C}}{ }\)-almost every \(x \in X\), the inequalities\\
(a) \(\quad \liminf _{t \rightarrow 0} \inf _{i \in \mathbb{N}} \frac{g_{i}(x+t e)-g_{i}(x)}{t} \geq \inf _{i \in \mathbb{N}} \limsup _{t \rightarrow 0} \frac{g_{i}(x+t e)-g_{i}(x)}{t}\)\\
and\\
(b) \(\quad \limsup _{t \rightarrow 0} \sup _{i \in \mathbb{N}} \frac{g_{i}(x+t e)-g_{i}(x)}{t} \leq \sup _{i \in \mathbb{N}} \liminf _{t \rightarrow 0} \frac{g_{i}(x+t e)-g_{i}(x)}{t}\)\\
hold for every \(e \in X\).\\
Proof. We may assume that \(\operatorname{Lip}\left(g_{i}\right) \leq 1\) for every \(i\). Let \(D\) be a countable dense subset of \(\mathcal{S}_{X}\). For a fixed \(e \in D\), the set of \(x\) at which (a) fails is the union of the sets \(N_{\alpha, \beta}\) from Lemma 2.7 over rational \(\alpha<\beta\). Hence for \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost every \(x \in X\), the inequality (a) holds for every \(e \in D\) and so, since both its sides are Lipschitz and positively 1-homogeneous, for every \(e \in X\). The inequality (b) follows by applying (a) to the sequence \(-g_{i}\).

We finish this section by combining Lemma 2.8 with results on directional porosity to show a differentiability result for sequences of real-valued functions on subsets of separable Banach spaces that will turn out to be the main ingredient of the proofs of weak \({ }^{\star}\), Hadamard, Gâteaux and metric differentiability outside \(\mathscr{\mathcal { C }}\)-null sets in Section 4.

Theorem 2.9: Let \(h_{0}, h_{1}, \ldots\) be real-valued functions defined on a subset \(M\) of a separable Banach space \(X\). Then for \(\mathcal{\mathcal { C }}\)-almost every \(x \in M\) satisfying

\[
\limsup _{M \ni y \rightarrow x} \sup _{i \in \mathbb{N}} \frac{\left|h_{i}(y)-h_{i}(x)\right|}{\|y-x\|}<\infty
\]

there are \(x_{i}^{*} \in X^{*}, i \in \mathbb{N}\), such that\\
(i) for every \(i \in \mathbb{N}\), \(u_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u\) and \(x+t_{k} u_{k} \in M\),

\[
\lim _{k \rightarrow \infty} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)}{t_{k}}=x_{i}^{*}(u)
\]

(ii) for every \(u_{k}, v_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u, v_{k} \rightarrow v, x+t_{k} u_{k} \in M\) and \(x+t_{k} v_{k} \in M\),

\[
\lim _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}}=\sup _{i \in \mathbb{N}} x_{i}^{*}(u-v)
\]

Proof. By Lemmas 1.10 and 2.2 we find \(h_{i, j}: X \rightarrow \mathbb{R}\) with \(\operatorname{Lip}\left(h_{i, j}\right) \leq 1\) such that for \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-almost every \(x \in M\) satisfying (9) there are \(\kappa(x) \geq 0\) and \(j(x) \in \mathbb{N}\) such that\\
(10) \(\lim _{k \rightarrow \infty} \sup _{i \in \mathbb{N}}\left|\frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)}{t_{k}}-\kappa(x) \frac{h_{i, j(x)}\left(x+t_{k} u\right)-h_{i, j(x)}(x)}{t_{k}}\right|=0\)\\
whenever \(u_{k} \in X, u_{k} \rightarrow u, t_{k} \rightarrow 0\) and \(x+t_{k} u_{k} \in E\).\\
By Proposition 2.3, at \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost every \(x \in X\) all the functions \(h_{i, j}\) are Gâteaux differentiable. This and (10) imply that (i) holds with \(x_{i}^{*}=\kappa(x) h_{i, j(x)}^{\prime}(x)\). Moreover, for \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-almost all \(x\) we infer from Lemma 2.8 with \(g_{i}=h_{i, j}\) that

\[
\limsup _{t \rightarrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i, j}(x+t e)-h_{i, j}(x)}{t} \leq \sup _{i \in \mathbb{N}} h_{i, j}^{\prime}(x ; e)
\]

for every \(j\) and every \(e \in X\). We also have

\[
\liminf _{t \rightarrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i, j}(x+t e)-h_{i, j}(x)}{t} \geq \liminf _{t \rightarrow 0} \frac{h_{i, j}(x+t e)-h_{i, j}(x)}{t} \geq h_{i, j}^{\prime}(x ; e)
\]

for every \(i\), from which we see that

\[
\lim _{t \rightarrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i, j}(x+t e)-h_{i, j}(x)}{t}=\sup _{i \in \mathbb{N}} h_{i, j}^{\prime}(x ; e) .
\]

Hence, by Lemma 1.11, \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost every \(x\) satisfies

\[
\lim _{t \rightarrow 0} \sup _{i \in \mathbb{N}} \frac{h_{i, j}(x+t u)-h_{i, j}(x+t v)}{t}=\sup _{i \in \mathbb{N}} h_{i, j}^{\prime}(x ; u-v)
\]

for every \(j \in \mathbb{N}\) and \(u, v \in X\). Hence, estimating

\[
\begin{aligned}
& \sup _{i \in \mathbb{N}} \mid \left.\frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}}-\kappa(x) \frac{h_{i, j(x)}\left(x+t_{k} u\right)-h_{i, j(x)}\left(x+t_{k} v\right)}{t_{k}} \right\rvert\, \\
& \leq \sup _{i \in \mathbb{N}}\left|\frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)}{t_{k}}-\kappa(x) \frac{h_{i, j(x)}\left(x+t_{k} u\right)-h_{i, j(x)}(x)}{t_{k}}\right| \\
& \quad+\sup _{i \in \mathbb{N}}\left|\frac{h_{i}\left(x+t_{k} v_{k}\right)-h_{i}(x)}{t_{k}}-\kappa(x) \frac{h_{i, j(x)}\left(x+t_{k} v\right)-h_{i, j(x)}(x)}{t_{k}}\right|,
\end{aligned}
\]

we infer (ii) from (10) and (11).

\section*{3. Gâteaux differentiability of cone-monotone functions}
Definition 3.1: A function \(f: X \rightarrow \mathbb{R}\) is said to be monotone in the direction of a cone \(C\) if \(f(y) \geq f(x)\) whenever \(y-x \in C\).

Lemma 3.2: Suppose \(f\) is monotone in the direction of \(C\) and \(e \in C\). Then \(f\) is Lipschitz at a point \(x\) if and only if \(\bar{D} f(x, e)<\infty\).

Proof. The opposite implication being obvious, suppose \(\bar{D} f(x, e)<\infty\) where \(e \in C\) and \(\|e\|=1\). Find \(a<\infty\) and \(\delta>0\) so that \(\frac{f(x+t e)-f(x)}{t}<a\) for \(0<|t|<\delta\). Choose \(\tau>0\) so that \(C(e, 2 \tau) \subset C\). If \(0<\|y-x\|<\tau \delta\), we let \(t=\|y-x\| / \tau\), and use Lemma 1.5 to infer that \((x+t e)-y \in C\), which gives \(f(y) \leq f(x+t e) \leq f(x)+a\|y-x\| / \tau\), and \(y-(x-t e) \in C\), which gives \(f(y) \geq f(x-t e) \geq f(x)-a\|y-x\| / \tau\).

Proposition 3.3: If \(f: X \rightarrow \mathbb{R}\) is monotone in the direction of \(C=C(e, \tau)\), the set of points at which \(f\) is not Lipschitz is regularly \(C(e, \sigma)\)-null for every \(0<\sigma<\tau\).

Proof. We fix \(0<\sigma<\tau\) and \(0<r<\infty\) and show that the set

\[
N:=\left\{x \in B(0, r): \limsup _{t \rightarrow 0} \frac{f(x+t e)-f(x)}{t}=\infty\right\}
\]

is regularly \(C(e, \sigma)\)-null. Since regularly \(C(e, \sigma)\)-null sets form a \(\sigma\)-ideal, this and Lemma 3.2 will prove the statement.

Let \(r_{0}=r+1+\sigma\) and \(c=\sup \left\{|f(x)|: x \in B\left(0, r_{0}\right)\right\}\). Then \(c<\infty\) since \(B\left(0, r_{0}\right)\) is contained in \(\left(-r_{0} e / \tau+C\right) \cap\left(r_{0} e / \tau-C\right)\).

Given \(\varepsilon>0\) let \(\alpha=\varepsilon(1-\sigma / \tau), \kappa=10 c / \alpha\) and define

\[
G=\{x \in B(0, r): f(x+t e)-f(x-t e)>\kappa t \text { for some } 0<t<\alpha\}
\]

For every \(x \in N\) there is \(0<|s|<\alpha\) such that \(|f(x+s e)-f(x)|>\kappa|s|\), and monotonicity implies \(f(x+|s| e)-f(x-|s| e) \geq|f(x+s e)-f(x)|>\kappa|s|\). Hence \(N \subset G\).

To prove that \(G\) is open, suppose \(x_{0} \in G\) with the corresponding \(t\). Choose \(0<\eta<\alpha-t\) with \(f\left(x_{0}+t e\right)-f\left(x_{0}-t e\right)>\kappa t+\kappa \eta\). If \(\left\|x-x_{0}\right\|<\tau \eta\), we let \(s=t+\eta\) and infer from Lemma 1.5 that \((x+s e)-\left(x_{0}+t e\right) \in C\) and \(\left(x_{0}-t e\right)-(x-s e) \in C\). Hence \(f(x+s e)-f(x-s e) \geq f\left(x_{0}+t e\right)-f\left(x_{0}-t e\right)>\) \(\kappa t+\kappa \eta=\kappa s\), and we see that \(x \in G\). Consequently, \(G\) is open.

We fix \(\gamma \in C^{1}(\mathbb{R}, X)\) such that \(\left\|\gamma^{\prime}-e\right\|<\sigma\) and, by considering the behaviour of \(f \circ \gamma\) on the interval \((0,1)\), estimate the measure of \(H:=(\varepsilon, 1-\varepsilon) \cap \gamma^{-1}(G)\). Notice that \(f \circ \gamma\) is nondecreasing since for any \(s<t,\|\gamma(t)-\gamma(s)-(t-s) e\|<\) \(\sigma(t-s)\), and so \(\gamma(t)-\gamma(s) \in C\).

To apply a covering theorem, let \(\mathcal{J}\) be the collection of intervals \(J=(u, v) \subset\) \((0,1)\) such that \(f(\gamma(u))-f(\gamma(v))>\kappa_{0}(u-v)\), where \(\kappa_{0}=10 c / \varepsilon\). We prove that \(H \subset \bigcup \mathcal{J}\). If \(h \in H\), find \(0<t<\alpha\) with \(f(\gamma(h)+t e)-f(\gamma(h)-t e)>\kappa t\). Let \(s=\tau t /(\tau-\sigma)\). Since \(s<\tau \alpha /(\tau-\sigma)=\varepsilon\), we see \((h-s, h+s) \subset(0,1)\). Also, since \(\|\gamma(h+s)-(\gamma(h)+s e)\|<\sigma s=\tau(s-t)\), we have \(\gamma(h+s)-(\gamma(h)+t e) \in C\). Similarly, \((\gamma(h)-t e)-\gamma(h-s) \in C\), and hence

\[
f(\gamma(h+s))-f(\gamma(h-s)) \geq f(\gamma(h)+t e)-f(\gamma(h)-t e)>\kappa t=\kappa_{0} s
\]

It follows that \((h-s, h+s) \in \mathcal{J}\), as needed.\\
Assuming \(H \neq \emptyset\), we have \(\max (\|\gamma(0)\|,\|\gamma(1)\|) \leq r+\operatorname{Lip}(\gamma)<r_{0}\). Hence \(f(\gamma(1))-f(\gamma(0)) \leq 2 c\). By the \(5 r\) covering theorem (Lemma 1.6 with \(q=0\) and \(\lambda(I)=|I|)\) choose a disjoint \(\mathcal{I} \subset \mathcal{J}\) such that for every \(J \in \mathcal{J}\) there is \(I \in \mathcal{I}\) with \(I \cap J \neq \emptyset\) and \(|J| \leq 2|I|\). Since \(f \circ \gamma\) is nondecreasing and \(f(b)-f(a)>2 \kappa_{0}(b-a)\) for every \((a, b) \in \mathcal{I}, 2 c \geq f(\gamma(1))-f(\gamma(0)) \geq 2 \kappa_{0}|\bigcup \mathcal{I}|\), and we infer that \(|\bigcup \mathcal{I}| \leq c / \kappa_{0}\), so \(|H| \leq|\bigcup \mathcal{J}| \leq 5|\bigcup \mathcal{I}|<\varepsilon\) and \(\left|(0,1) \cap \gamma^{-1}(G)\right|<3 \varepsilon\).

Proposition 3.4: If \(E \subset X\) is regularly null in the direction of a cone \(C\), there is a function \(f\) monotone in the direction of \(C\) such that

\[
\lim _{t \rightarrow 0} \inf \left\{\frac{f(x+t u)-f(x)}{t}: u \in C,\|u\|=1\right\}=\infty
\]

In particular, \(\underline{D} f(x ; u)=\infty\) for every \(x \in E\) and \(u \in C\).\\
Proof. Let \(G_{n} \supset E\) be open sets such that \(\left|\gamma^{-1}\left(G_{n}\right)\right|<2^{-n}\) for every \(\gamma \in \Gamma_{C}\). Define

\[
f_{n}(x)=\sup \left\{\left|\gamma^{-1}\left(G_{n}\right) \cap(-\infty, t)\right|: \gamma \in \Gamma_{C}, \gamma(t)=x\right\}
\]

Clearly \(0 \leq f_{n} \leq 2^{-n}\), and so the function \(f:=\sum_{n=1}^{\infty} f_{n}\) is well defined.\\
Let \(x, y \in X\) be such that \(y-x \in C\). For any \(\varepsilon>0\) and \(n \in \mathbb{N}\) there is \(\gamma \in \Gamma_{C}\) and \(t \in \mathbb{R}\) such that \(\gamma(t)=x\) and \(\left|\gamma^{-1}\left(G_{n}\right) \cap(-\infty, t)\right|>f_{n}(x)-\varepsilon\). Defining \(\hat{\gamma} \in \Gamma_{C}\) such that \(\hat{\gamma}(s)=\gamma(s)\) for \(s \leq t-\varepsilon\) and \(\hat{\gamma}(s)=x+(s-t)(y-x) /\|y-x\|\) for \(s \geq t+\varepsilon\), and using that \(\varepsilon>0\) is arbitrary, we see that

\[
f_{n}(y) \geq f_{n}(x)+\left|\left\{s \in[t, t+\|y-x\|]: x+(s-t)(y-x) /\|y-x\| \in G_{n}\right\}\right|
\]

Hence \(f_{n}\) is monotone in the direction of \(C\) and \(f_{n}(y) \geq f_{n}(x)+\|y-x\|\) provided that the segment \([x, y]\) lies in \(G_{n}\).

It follows that \(f\) is monotone in the direction of \(C\). If \(x \in E\) and \(m \in \mathbb{N}\), there is \(\delta>0\) such that \([x-\delta u, x+\delta u] \subset \bigcap_{n=1}^{m} G_{n}\) whenever \(u \in C\) and \(\|u\|=1\).

Since \(\sum_{n=m+1}^{\infty} f_{n}\) is monotone, we infer from (12) that

\[
\frac{f(x+t u)-f(x)}{t} \geq \sum_{n=1}^{m} \frac{f_{n}(x+t u)-f_{n}(x)}{t} \geq m
\]

for \(0<|t|<\delta\), and the statement follows.\\
Propositions 2.3, 3.3 and 3.4 easily combine to a proof of the announced description of the \(\sigma\)-ideal generated by Gâteaux nodifferentiability sets of conemonotone functions.

Theorem 3.5: In every separable Banach space \(X\), the \(\sigma\)-ideal \(\mathcal{C}\) is generated by the sets of Gâteaux non-differentiability of cone-monotone functions on \(X\).

Proof. If \(E\) is \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-null, \(E=\bigcup_{i=1}^{\infty} E_{i}\) where each \(E_{i}\) is regularly null in the direction of some cone \(C_{i}\). By Proposition 3.4 find functions \(f_{i}\) monotone in the direction of \(C_{i}\) such that \(\underline{D} f_{i}(x ; u)=\infty\) for \(x \in E_{i}\) and \(u \in C_{i}\), and infer that each \(E_{i}\) is the set of Gâteaux non-differentiability of the cone-monotone function \(f_{i}\).

To prove the converse, suppose \(f\) is monotone in the direction of some cone. By Proposition 3.3 the set \(N_{0}:=\left\{x: \operatorname{Lip}_{x}(f)=\infty\right\}\) is \(\mathcal{C}\)-null. Hence \(f\) is Gâteaux differentiable \(\stackrel{ٌ}{\mathcal{C}}\)-almost everywhere by Proposition 2.3.

To prove a local version of the differentiability result for cone monotone functions, we need their simple extension property.

Lemma 3.6: Let \(C\) be a cone in a Banach space \(X\) and \(E \subset X\). Every bounded function \(h: E \rightarrow \mathbb{R}\) such that \(h(y) \geq h(x)\) whenever \(x, y \in E\) satisfy \(y-x \in C\) can be extended to a function \(g: X \rightarrow \mathbb{R}\) monotone in the direction of \(C\).

Proof. Let \(D=C \cup\{0\}, A=\{x: E \cap(x-D) \neq \emptyset\}\) and define

\[
g(x)= \begin{cases}\sup _{u \in E \cap(x-D)} h(u) & \text { if } x \in A, \text { and } \\ \inf _{u \in A \cap(x+D)} g(u) & \text { if } x \notin A\end{cases}
\]

Notice that (except in the trivial case \(E=\emptyset\) ) these suprema and infima are over nonempty sets, the first by definition of \(A\) and the second since for every \(x \in X\) and \(x_{0} \in E, \emptyset \neq(x+C) \cap\left(x_{0}+C\right) \subset A\). Hence \(g\) is well-defined and \(\inf h \leq g(x) \leq \sup h\) for every \(x\). Monotonicity of \(g\) follows by considering possible cases for points \(x, y\) with \(y-x \in C\) : if \(x \in A\), then \(y \in A\) and \(x-D \subset y-D\); if \(y \notin A\), then \(x \notin A\) and \(y+D \subset x+D\); and if \(x \notin A\) and \(y \in A\), then \(y \in A \cap(x+D)\). Similarly easily one sees that \(g\) extends \(h\) : if \(x \in E\)\\
then \(x \in A\) and we get \(g(x) \geq h(x)\) from \(x \in E \cap(x-D)\) and \(g(x) \leq h(x)\) since \(h(u) \leq h(x)\) for \(u \in E \cap(x-D)\) by assumption.

Proposition 3.7: Let \(f\) be a real-valued function on a separable Banach space \(X\) and let \(E\) be the set of \(x\) for which there is a cone \(C_{x}\) in \(X\) and \(\delta_{x}>0\) such that \(f(x+u) \geq f(x) \geq f(x-u)\) for \(u \in C_{x}\) with \(\|u\|<\delta_{x}\). Then there is a \(\stackrel{\curvearrowright}{\mathcal{C}}\)-null set \(N\) such that \(f\) is Lipschitz at every \(x \in E \backslash N\).

Proof. It suffices to fix a cone \(C=C(e, \tau)\) and \(\delta>0\) and consider only the set \(E\) of those \(x\) that satisfy \(C_{x} \supset C\) and \(\delta_{x}>\delta\). Writing further \(E\) as a union of countably many sets of small diameter on which \(f\) is bounded, we may also assume that \(\operatorname{diam}(E)<\delta\) and \(f\) is bounded on \(E\). Since then the restriction of \(f\) to \(E\) satisfies the assumptions of Lemma \(3.6, f\) on \(E\) coincides with a restriction of a function \(g: X \rightarrow \mathbb{R}\) which is monotone in the direction of \(C\). By Proposition \(3.3, g\) is Lipschitz at \(\mathcal{C}\)-almost every point of \(X\).

Let \(x \in E\) be such that \(\operatorname{Lip}_{x}(g)<\infty\) and \(E\) is not directionally porous at \(x\). We show that \(\operatorname{Lip}_{x}(f)<\infty\). If \(\|u\|\) is small enough, we let \(t=2\|u\| / \tau\) and find \(u_{1}, u_{2} \in X\) such that \(x-u_{1} \in E, x+u_{2} \in E,\left\|u_{1}-t e\right\|<\frac{1}{2} \tau t\) and \(\left\|u_{2}-t e\right\|<\frac{1}{2} \tau t\). Then \(u+u_{1}, u_{2}-u \in C\) and so, with \(c=(1+2 / \tau) \operatorname{Lip}_{x}(g)\),

\[
f(x+u) \geq f\left(x-u_{1}\right)=g\left(x-u_{1}\right) \geq g(x)-\operatorname{Lip}_{x}(g)\left\|u_{1}\right\| \geq f(x)-c\|u\|
\]

and

\[
f(x+u) \leq f\left(x+u_{2}\right)=g\left(x+u_{2}\right) \leq g(x)+\operatorname{Lip}_{x}(g)\left\|u_{2}\right\| \leq f(x)+c\|u\|
\]

implying that \(\operatorname{Lip}_{x}(f) \leq c\).\\
Proposition 3.8: Let \(f\) be a real-valued function on an open subset \(G\) of a separable Banach space \(X\). Then there is a \(\stackrel{\mathcal{C}}{\mathrm{C}}\)-null set \(N \subset G\) such that for every \(x \in G \backslash N\) either \(f\) is Gâteaux differentiable at \(x\) or every cone \(C\) in \(X\) has at least one of the following two properties:

\[
\limsup _{C \ni u \rightarrow 0} \frac{f(x+u)-f(x)}{\|u\|}=\limsup _{C \ni u \rightarrow 0} \frac{f(x-u)-f(x)}{\|u\|}=\infty
\]

\[
\liminf _{C \ni u \rightarrow 0} \frac{f(x+u)-f(x)}{\|u\|}=\liminf _{C \ni u \rightarrow 0} \frac{f(x-u)-f(x)}{\|u\|}=-\infty
\]

Proof. By Lemmas 2.3 and 1.12 it suffices to show \(\mathcal{\mathcal { C }}\)-nullness of the set of points \(x\) for which there is a cone \(C=C(e, \tau)\), where \(\|e\|=1\) and \(0<\tau<1\), such\\
that (A) and (B) fail and\\
(13) \(\quad \limsup _{C \ni u \rightarrow 0} \frac{|f(x+u)-f(x)|}{\|u\|}=\infty \quad\) and \(\quad \limsup _{C \ni u \rightarrow 0} \frac{|f(x-u)-f(x)|}{\|u\|}=\infty\).

Replacing \(C\) by \(-C\) if necessary, the failure of (A) and (B) then means that there are \(0<c, \delta<\infty\) such that

\[
f(x+u)-f(x) \leq c\|u\| \text { and } f(x)-f(x-u) \leq c\|u\| \text { for } u \in C \text { and }\|u\|<\delta
\]

Writing the set of these points as a countable union of sets \(E\) for which there are \(0<c, \delta<\infty\) and a single cone \(C\) such that (13) and (14) hold for every \(x \in E\), we are left with showing that \(E \in \mathscr{\mathcal { C }}\).

Let \(x^{*} \in X^{*}\) be such that \(\left\|x^{*}\right\|=x^{*}(e)=1\). If \(c_{0}\) is large enough, it follows that the function \(h(x):=c_{0} x^{*}(x)-f(x)\) satisfies \(h(x+u) \geq h(x) \geq h(x-u)\) for \(x \in E, u \in C,\|u\|<\delta\). By Lemma 3.6, \(\operatorname{Lip}_{x}(f) \leq \operatorname{Lip}_{x}(h)+c_{0}<\infty\) for \(\stackrel{\mathscr{C}}{ }\)-almost all \(x \in E\). Hence (13) implies that \(E\) is \(\stackrel{\mathcal{C}}{ }\)-null, as required.

\section*{4. Weak \({ }^{\star}\), Hadamard, Gâteaux and metric differentiability}
Here we point out that usual variants of Rademacher's and Stepanov's theorems holding \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost everywhere may be proved based on the results of Section 2 in a way similar to how they are proved with other notions of null sets. Our key result concerns a variant of the so-called weak \({ }^{\star}\)-differentiability. Since this notion is used in several different meanings, we describe some of its variants and relevant results in some detail. However, to avoid technicalities we will not specify the classes of null sets used by different authors.

Let \(f\) map an open subset \(E\) of a Banach space \(X\) to the dual \(Y^{*}\) of a Banach space \(Y\). Its weak*-Gâteaux derivative at \(x \in E\) is a continuous linear map \(T: X \rightarrow Y^{*}\) such that

\[
w^{*}-\lim _{t \rightarrow 0} \frac{f(x+t u)-f(x)}{t}=T(u)
\]

for every \(u \in X\). Almost everywhere existence results for weak*-Gâteaux differentiability, assuming \(X, Y\) separable and \(f\) Lipschitz, were proved by Aronszajn [4]. A well-known difficulty in the application of this notion is that \(T\) may be zero even when \(f\) is a bi-Lipschitz isomorphism of \(X\) onto \(Y^{*}\). Heinrich and Mankiewicz [15] proved that this anomaly can occur only at points of a null set. A natural form of their result, which is stronger than what they prove, shows\\
that when \(X, Y\) are separable and \(f\) is Lipschitz, for almost every \(x \in E\) the \(T\) for which (15) holds also satisfies

\[
\lim _{t \rightarrow 0}\left\|\frac{f(x+t u)-f(x)}{t}\right\|=\|T(u)\|
\]

for every \(u \in X\). When \(\operatorname{dim}(X)<\infty\), this follows from the results of Kirchheim [18], but it was fully stated only by Ambrosio and Kirchheim in [3]. The infinite dimensional case was proved by Duda [10] who treated even the pointwise Lipschitz situation. Because of the importance of the additional result, some authors, including the present one, tend to mean by weak \({ }^{\star}\)-differentiability not only the weak*-Gâteaux differentiability, but also validity of (16). This can sometimes lead to a confusion, in particular since a useful strengthening of (16), namely

\[
\lim _{t \rightarrow 0}\left\|\frac{f(x+t u)-f(x+t v)}{t}\right\|=\|T(u-v)\|
\]

for every \(u, v \in X\), was also proved in [3] under the same assumption as (16).\\[0pt]
All the above notions may be (and have been, for example in [10]) combined with Hadamard's approach to differentiability. We will not repeat the definitions, just state and prove the following theorem corresponding to the strongest form of the almost everywhere weak*-differentiability results mentioned above.

Theorem 4.1: Let \(f\) be a map of a subset \(E\) of a separable Banach space \(X\) to the dual \(Y^{*}\) of a separable Banach space \(Y\). Then for \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost every \(x \in E\) at which \(\operatorname{Lip}_{x}(f, E)<\infty\) there is a bounded linear map \(T_{x}: X \rightarrow Y^{*}\) such that\\
(i) for every \(u_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u\) and \(x+t_{k} u_{k} \in E\),

\[
w^{*}-\lim _{k \rightarrow \infty} \frac{f\left(x+t_{k} u_{k}\right)-f(x)}{t_{k}}=T_{x}(u)
\]

(ii) for every \(u_{k}, v_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u, v_{k} \rightarrow v, x+t_{k} u_{k} \in E\) and \(x+t_{k} v_{k} \in E\),

\[
\lim _{k \rightarrow \infty}\left\|\frac{f\left(x+t_{k} u_{k}\right)-f\left(x+t_{k} v_{k}\right)}{t_{k}}\right\|=\left\|T_{x}(u-v)\right\|
\]

Proof. Let \(y_{1}, y_{2}, \ldots \in \mathcal{S}_{Y}\) be dense in \(\mathcal{S}_{Y}\) and define \(h_{i}: E \rightarrow \mathbb{R}\) by \(h_{i}(x)=\) \(\left\langle f(x), y_{i}\right\rangle\). By Lemma 2.2 and Theorem 2.9 there is a \(\stackrel{\circ}{\mathcal{C}}\)-null set \(N\) such that every \(x \in E \backslash N\) is a non-directional porosity point of \(E\) and there are \(x_{i}^{*} \in X^{*}\), \(i \in \mathbb{N}\), such that\\
(a) for every \(i \in \mathbb{N}, u_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u\) and \(x+t_{k} u_{k} \in E\),

\[
\lim _{k \rightarrow \infty} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}(x)}{t_{k}}=x_{i}^{*}(u)
\]

(b) for every \(u_{k}, v_{k} \in X\) and \(t_{k} \rightarrow 0\) such that \(u_{k} \rightarrow u, v_{k} \rightarrow v, x+t_{k} u_{k} \in E\) and \(x+t_{k} v_{k} \in E\),

\[
\lim _{k \rightarrow \infty} \sup _{i \in \mathbb{N}} \frac{h_{i}\left(x+t_{k} u_{k}\right)-h_{i}\left(x+t_{k} v_{k}\right)}{t_{k}}=\sup _{i \in \mathbb{N}} x_{i}^{*}(u-v) .
\]

Define \(T_{x}(u)(y)=r\) provided that \(x \in E \backslash N, u \in X, y \in Y\) and \(r \in \mathbb{R}\) have the property that

\[
\lim _{k \rightarrow \infty} \frac{\left\langle f\left(x+t_{k} u_{k}\right)-f(x), y\right\rangle}{t_{k}}=r
\]

for every \(t_{k} \rightarrow 0\) and \(u_{k} \in X\) satisfying \(u_{k} \rightarrow u\) and \(x+t_{k} u_{k} \in E\). Since \(x\) is not a point of directional porosity of \(E\), such \(t_{k}\) and \(u_{k}\) exist for every \(u\) by Lemma 1.8, and so \(T_{x}(u)(y)\), provided it exists, is determined uniquely by \(x, u, y\).

By (a), \(T_{x}(u)\left(t y_{i}\right)=t T_{x}(u)\left(y_{i}\right)=x_{i}^{*}(t u)\) is well defined for every \(t \in \mathbb{R}\) and \(i \in \mathbb{N}\). If \(x, u, z_{j}\) are such that \(z_{j} \rightarrow z\) and \(T_{x}(u)\left(z_{j}\right)\) are defined, and if \(t_{k}, u_{k}\) are as above, then for all large enough \(k\),

\[
\left|\frac{\left\langle f\left(x+t_{k} u_{k}\right)-f(x), z_{j}\right\rangle}{t_{k}}-\frac{\left\langle f\left(x+t_{k} u_{k}\right)-f(x), z\right\rangle}{t_{k}}\right| \leq \operatorname{Lip}_{x}(f, E)\left\|z-z_{j}\right\|
\]

Since the \(y_{i}\) form a dense subset of \(\mathcal{S}_{Y}\), it follows that \(T_{x}(u)(y)\) is well-defined for every \(x \in E \backslash N, u \in X\) and \(y \in Y\) and that the function \(y \rightarrow T_{x}(u)(y)\) is continuous. Moreover, (18) implies that \(\left|T_{x}(u)(y)\right| \leq \operatorname{Lip}_{x}(f, E)\|u\|\|y\|\) and that \(y \rightarrow T_{x}(u)(y)\) is linear. Hence \(u \rightarrow T_{x}(u) \operatorname{maps} X\) to \(Y^{*}\) and \(\left\|T_{x}(u)\right\| \leq\) \(\operatorname{Lip}_{x}(f, E)\|u\|\). Since the \(y_{i}\) are dense in \(\mathcal{S}_{Y}\) and \(u \rightarrow T_{x}(u)\left(y_{i}\right)=x_{i}^{*}(u)\) is linear for each \(i, T_{x}: X \rightarrow Y^{*}\) is a bounded linear map and (i) holds.

The statement (ii) is immediate from (b) since the left sides of the equalities in these statements are clearly equal, and so are their right sides because \(\sup _{i \in \mathbb{N}} x_{i}^{*}(u-v)=\sup _{i \in \mathbb{N}} T_{x}(u-v)\left(y_{i}\right)=\left\|T_{x}(u-v)\right\|\).

Theorem 4.2: Let \(f\) be a map of a subset \(E\) of a separable Banach space \(X\) to a Banach space \(Y\) with the Radon-Nikodym property. Then \(f\) is Hadamard differentiable at \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost every \(x \in E\) at which \(\operatorname{Lip}_{x}(f, E)<\infty\).

Proof. By Lemma 1.9 we may assume that \(Y\) is separable. Hence by [14] we may assume that \(Y\) is a subspace of the (possibly nonseparable) dual \(Z^{*}\) of a\\
separable Banach space \(Z\) and has the following property that was introduced in [17] under the name "asymptotic-norming property":\\
\((\star)\) If \(z_{n}^{*} \in Y, z^{*} \in Z^{*}, z_{n}^{*} \xrightarrow{w^{*}} z^{*}\) and \(\left\|z_{n}^{*}\right\| \rightarrow\left\|z^{*}\right\|\), then \(\left\|z_{n}^{*}-z^{*}\right\| \rightarrow 0\).\\
For \(\stackrel{\mathcal{C}}{\mathcal{C}}\)-almost every \(x \in E\) at which \(\operatorname{Lip}_{x}(f, E)<\infty\) we may use Theorem 4.1 to find a bounded linear map \(T_{x}: X \rightarrow Z^{*}\) such that 4.1(i) and 4.1(ii) hold. Whenever \(u_{k} \in X, t_{k} \rightarrow 0, u_{k} \rightarrow u\) and \(x+t_{k} u_{k} \in E\), we denote \(z_{k}^{*}:=\) \(\left(f\left(x+t_{k} u_{k}\right)-f(x)\right) / t_{k}\) and infer from 4.1(i) that \(z_{k}^{*} \xrightarrow{w^{*}} T_{x}(u)\) and from 4.1(ii) with \(v_{k}=0\) that \(\left\|z_{n}^{*}\right\| \rightarrow\left\|T_{x}(u)\right\|\). Hence

\[
\left\|z_{n}^{*}-T_{x}(u)\right\| \rightarrow 0
\]

by \((\star)\). In particular, \(T_{x}(u)\) belongs to \(Y\). Since by Lemma 1.8 such \(u_{k}, t_{k}\) exist for every \(u \in X, T_{x}\) maps \(X\) to \(Y\), and (19) shows that it is the Hadamard derivative of \(f\) at \(x\).

The Gâteaux differentiability result follows immediately, since at every interior point of an open set Hadamard differentiability implies Gâteaux differentiability. In fact, by Zajíček [25] these two concepts of differentiability coincide at all points of an open set at which \(f\) is Lipschitz, with the possible exception of a \(\sigma\)-directionally porous set.

Theorem 4.3: Let \(f\) be a map of an open subset \(G\) of a separable Banach space \(X\) to a Banach space \(Y\) with the Radon-Nikodym property. Then \(f\) is Gâteaux differentiable at \(\mathcal{\mathcal { C }}\)-almost every \(x \in G\) at which \(\operatorname{Lip}_{x}(f)<\infty\).

We also observe that the weak*-differentiability result of Theorem 4.1 im plies a metric differentiability result with the exception of points of a \(\stackrel{\mathscr{C}}{ }\)-null set. Metric differentiability was first proved in [18] for maps from \(\mathbb{R}^{n}\) and the possibility of deducing it from weak \({ }^{\star}\)-differentiability was noticed in [3]. Our result is similar to [10, Theorem 5.3], with the main differences being the use of \(\mathscr{\mathcal { C }}\)-null sets and of a somewhat stronger concept of differentiability that could be termed Hadamard-Kirchheim metric differentiability.

Theorem 4.4: Let \(f\) map a subset \(E\) of a separable Banach space \(X\) to a metric space \(M\). Then for \(\stackrel{ٌ}{\mathcal{C}}\)-almost every \(x \in E\) at which \(\operatorname{Lip}_{x}(f, E)<\infty\) there is a continuous seminorm \(\|\cdot\|_{x}\) on \(X\) such that for every compact set \(K \subset X\)\\
and \(\varepsilon>0\) there is \(\delta>0\) such that

\[
\left|\frac{\operatorname{dist}(f(x+t u), f(x+t v))}{t}-\|u-v\|_{x}\right|<\varepsilon
\]

whenever \(0<t<\delta, x+t u \in E, x+t v \in E\), \(\operatorname{dist}(u, K) \leq \delta\) and \(\operatorname{dist}(v, K) \leq \delta\).\\
Proof. By Lemma 1.9 we may assume that \(M\) is separable, and hence that it is contained in \(\ell_{\infty}=\ell_{1}^{*}\). By Theorem 4.1 for \(\mathcal{\mathcal { C }}\)-almost every \(x \in E\) with \(\operatorname{Lip}_{x}(f, E)<\infty\) there is a bounded linear map \(T_{x}: X \rightarrow \ell_{\infty}\) satisfying 4.1(i) and 4.1(ii). We show that the statement holds with \(\|u\|_{x}:=\left\|T_{x} u\right\|_{\ell_{\infty}}\). Indeed, if not, we could find a compact set \(K \subset X, \varepsilon>0, t_{k} \searrow 0, u_{k}, v_{k} \in X\) with \(\operatorname{dist}\left(u_{k}, K\right) \rightarrow 0\) and \(\operatorname{dist}\left(v_{k}, K\right) \rightarrow 0\) such that

\[
\left|\left\|f\left(x+t u_{k}\right)-f\left(x+t v_{k}\right)\right\|-t\left\|u_{k}-v_{k}\right\|_{x}\right| \geq \varepsilon t
\]

Passing to a subsequence, we may assume that \(u_{k} \rightarrow u\) and \(v_{k} \rightarrow v\) and infer that

\[
\liminf _{k \rightarrow \infty}\left|\left\|\frac{f\left(x+t_{k} u_{k}\right)-f\left(x+t_{k} v_{k}\right)}{t_{k}}\right\|-\left\|T_{x}(u-v)\right\|\right| \geq \varepsilon
\]

in contradiction to 4.1(ii).\\
We also notice that Rademacher's theorem extends to maps of finite cone variation from separable Banach spaces to Radon-Nikodym spaces. Recall that the variation of \(f: X \rightarrow Y\) in the direction of a cone \(C \subset X\) is the supremum of \(\sum_{i=0}^{m}\left\|f\left(x_{i}\right)-f\left(x_{i-1}\right)\right\|\) over all \(x_{0}, \ldots, x_{m} \in X\) satisfying \(x_{i}-x_{i-1} \in C\) for every \(i=1, \ldots, m\). Its finiteness implies that there is a function \(g: X \rightarrow \mathbb{R}\) monotone in the direction of \(C\) such that \(\|f(y)-f(x)\| \leq g(y)-g(x)\) for \(y-x \in C\). (So \(f\) is monotone dominated in terminology of [12].) Combining Proposition 3.3 with Lemma 1.12, we get that \(f\) is Lipschitz at \(\stackrel{\mathscr{C}}{ }\)-almost every point of \(X\). Hence, provided \(Y\) has the Radon-Nikodym property, \(f\) is Gâteaux differentiable \(\stackrel{\mathscr{C}}{\mathcal{C}}\)-almost everywhere by Theorem 4.3.

As our final remark, we show that the \(\sigma\)-ideal of \(\mathcal{\mathcal { C }}\)-null sets on a separable Banach space is generated by the sets of the weak \({ }^{\star}\)-nondifferentiability (where weak \({ }^{\star}\)-differentiability is defined by requiring validity of both (15) and (16)) of Lipschitz maps into duals of separable spaces.

Proposition 4.5: If \(E \subset X\) is regularly null in the direction of a cone \(C\) and \(e \in C\), there is a Lipschitz \(f: X \rightarrow \ell_{1}^{*}\) such that for every \(x \in E\),

\[
w^{*}-\lim _{t \rightarrow 0} \frac{f(x+t e)-f(x)}{t}=0
\]

and

\[
\lim _{t \rightarrow 0}\left\|\frac{f(x+t e)-f(x)}{t}\right\|=1
\]

Proof. We may assume that \(\|e\|=1, C=C(e, \tau)\) and there is \(e^{*} \in X^{*}\) such that \(\left\|e^{*}\right\|=e^{*}(e)=1\) and \(e^{*}(y)>0\) for every \(y \in C\). Let \(G_{n} \supset E\) be open sets such that \(\left|\gamma^{-1}\left(G_{n}\right)\right|<2^{-n}\) for every \(\gamma \in \Gamma_{C}\). Define

\[
f_{n}(x)=\inf \left\{e^{*}(\gamma(t))-\left|\gamma^{-1}\left(G_{n}\right) \cap(-\infty, t)\right|: \gamma \in \Gamma_{C}, \gamma(t)=x+s e, s \geq 0\right\}
\]

Clearly \(e^{*}(x)-2^{-n} \leq f_{n}(x) \leq e^{*}(x)\), and so \(f:=\left(f_{1}, f_{2}, \ldots\right)\) maps \(X\) to \(\ell_{\infty}=\ell_{1}^{*}\) and satisfies (21).

Let \(x, y \in X\). Whenever \(s, u \geq 0, y+u e-(x+s e) \in C\) and \(\gamma(t)=x+s e\), we may modify \(\gamma\) on \((t, \infty)\) so that \(\gamma(v)=y+u e\) for some \(v>t\) and estimate

\[
\begin{aligned}
f_{n}(y) \leq & e^{*}(\gamma(v))-\left|\gamma^{-1}\left(G_{n}\right) \cap(-\infty, v)\right| \\
= & e^{*}(\gamma(t))-\left|\gamma^{-1}\left(G_{n}\right) \cap(-\infty, t)\right| \\
& +e^{*}(y-x)+u-s-\left|\gamma^{-1}\left(G_{n}\right) \cap(t, v)\right| .
\end{aligned}
\]

Since the above assumptions hold whenever \(u>s+\|y-x\| / \tau\) we get \(f_{n}(y) \leq\) \(f_{n}(x)+(1+1 / \tau)\|y-x\|\) and \(\operatorname{Lip}(f)=\sup _{n} \operatorname{Lip}\left(f_{n}\right) \leq 1+1 / \tau\).

To prove (20), it suffices to show that \(f_{n}(x)=f_{n}(y)\) whenever \([x, y] \subset G_{n}\) and \(y-x=\eta e\) where \(\eta>0\). Since the above assumptions hold with \(u=\max (\eta, s-\eta)\) and \(\gamma\) may be modified so that \(\left|\gamma^{-1}\left(G_{n}\right) \cap(t, v)\right|\) is arbitrarily close to \(\eta+u-s\), we have that \(f_{n}(y) \leq f_{n}(x)\). The opposite inequality is obvious since every \(\gamma\) used in the definition of \(f_{n}(y)\) may be used in the definition of \(f_{n}(x)\).

\section*{References}
[1] G. Alberti, M. Csörnyei and D. Preiss, Differentiability of Lipschitz functions, structure of null sets, and other problems, in Proceedings of the International Congress of Mathematicians. Volume III, Hindustan Book Agency, New Delhi, 2010, pp. 1379-1394.\\[0pt]
[2] G. Alberti, M. Csörnyei and D. Preiss, Structure of null sets, differentiability of Lipschitz functions, and other problems, in preparation\\[0pt]
[3] L. Ambrosio and B. Kirchheim, Rectifiable sets in metric and Banach spaces, Mathematische Annalen 318 (2000), 527-555.\\[0pt]
[4] N. Aronszajn, Differentiability of Lipschitzian mappings between Banach spaces, Studia Mathematica 57 (1976), 147-190.\\[0pt]
[5] Y. Benyamini and J. Lindenstrauss, Geometric Nonlinear Functional Analysis. Vol. 1, American Mathematical Society Colloquium Publications, Vol. 48, American Mathematical Society, Providence, RI, 2000.\\[0pt]
[6] D. N. Bessis and F. H. Clarke, Partial subdifferentials, derivatives and Rademacher's theorem, Transactions o the American Mathematical Society 351 (1999), 2899-2926.\\[0pt]
[7] D. Bongiorno, Stepanoff's theorem in separable Banach spaces, Commentationes Mathematicae Universitatis Carolinae 39 (1998), 323-335.\\[0pt]
[8] J. M. Borwein, J. V. Burke and A. S. Lewis, Differentiability of cone-monotone functions on separable Banach space, Proceedings of the American Mathematical Society 132 (2004), 1067-1076.\\[0pt]
[9] M. Csörnyei and P. Jones, Product Formulas for Measures and Applications to Analysis and Geometry, \href{http://www.math.sunysb.edu/Videos/dfest/PDFs/38-Jones.pdf}{www.math.sunysb.edu/Videos/dfest/PDFs/38-Jones.pdf}\\[0pt]
[10] J. Duda, Metric and \(w^{\star}\)-differentiability of pointwise Lipschitz mappings, Zeitschrift für Analysis und ihre Anwendungen 26 (2007), 341-362.\\[0pt]
[11] J. Duda, On Gâteaux differentiability of pointwise Lipschitz mappings, Canadian Mathematical Bulletin 51 (2008), 205-216.\\[0pt]
[12] J. Duda, Cone monotone mappings: continuity and differentiability, Nonlinear Analyais 68 (2008), 1963-1972.\\[0pt]
[13] H. Federer, Geometric Measure Theory, Die Grundlehren der Mathematischem Wissenschaften, Band 153, Springer, New York, 1969.\\[0pt]
[14] N. Ghoussoub and B. Maurey, The asymptotic-norming and the Radon-Nikodym properties are equivalent in separable Banach spaces, Proceedings of the American Mathematical Society 94 (1985), 665-671.\\[0pt]
[15] S. Heinrich and P. Mankiewicz, Applications of ultrapowers to the uniform and Lipschitz classification of Banach spaces, Studia Mathematica 73 (1982), 225-251.\\[0pt]
[16] A. D. Ioffe, Typical convexity (concavity) of Dini-Hadamard upper (lower) directional derivatives of functions on separable Banach spaces, Journal of Convex Analysis 17 (2010), 1019-1032.\\[0pt]
[17] R. C. James and A. Ho, The asymptotic-norming and Radon-Nikodym properties for Banach spaces, Arkiv för Matematik 19 (1981), 53-70.\\[0pt]
[18] B. Kirchheim, Rectifiable metric spaces: local structure and regularity of the Hausdorff measure, Proceedings of the American Mathematical Society 121 (1994), 113-123.\\[0pt]
[19] J. Lindenstrauss, D. Preiss and J. Tišer, Fréchet Differentiability of Lipschitz Maps and Porous Sets in Banach Spaces, Annals of Mathematics Studies, Vol. 179, Princeton University Press, Princeton, NJ, 2012.\\[0pt]
[20] O. Maleva and D Preiss, Directional upper derivatives and the chain rule formula for locally Lipschitz functions on Banach spaces, Transactions of the American Mathematical Society, to appear.\\[0pt]
[21] P. Mattila, Geometry of Sets and Measures in Euclidean Spaces: Fractals and Rectifiability, Cambridge studies in Advanced Mathematics, Vol. 44, Cambridge University Press, Cambridge, 1995.\\[0pt]
[22] D. Preiss and G. Speight, Differentiability of Lipschitz functions in Lebesgue null sets, Inventiones Mathematicae, 2014, to appear. DOI: 10.1007/s00222-014-0520-5.\\[0pt]
[23] D. Preiss and L. Zajíček, Directional derivatives of Lipschitz functions, Israel Journal of Mathematics 125 (2001), 1-27.\\[0pt]
[24] L. Zajíček, Gâteaux and Hadamard differentiability via directional differentiability, Journal of Convex Analysis, to appear. arXiv:1211.2604 [math.FA].\\[0pt]
[25] L. Zajíček, Hadamard differentiability via Gâteaux differentiability, Proceedings of the American Mathematical Society, to appear. arXiv:1210.4715 [math.FA].\\[0pt]
[26] L. Zajíček, Properties of Hadamard directional derivatives: Denjoy-Young-Saks theorem for functions on Banach spaces, Journal of Convex Analysis, to appear. arXiv:1308.2415 [math.FA].

\begin{itemize}
  \item 
\end{itemize}


\end{document}