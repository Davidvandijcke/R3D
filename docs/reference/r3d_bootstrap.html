<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiplier Bootstrap for Distributional RDD — r3d_bootstrap • R3D</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiplier Bootstrap for Distributional RDD — r3d_bootstrap"><meta property="og:description" content="Performs a multiplier bootstrap to obtain uniform confidence bands
and (optionally) conduct hypothesis tests for an R3D or F3D design.
It reuses the partial-sum intercept weights and residuals from a fitted r3d object
to avoid re-estimating local polynomial regressions within each bootstrap loop."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">R3D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiplier Bootstrap for Distributional RDD</h1>
    
    <div class="hidden name"><code>r3d_bootstrap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a multiplier bootstrap to obtain uniform confidence bands
and (optionally) conduct hypothesis tests for an <em>R3D</em> or <em>F3D</em> design.
It reuses the partial-sum intercept weights and residuals from a fitted <code>r3d</code> object
to avoid re-estimating local polynomial regressions within each bootstrap loop.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">r3d_bootstrap</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y_list</span>,</span>
<span>  T <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"nullity"</span>, <span class="st">"homogeneity"</span>, <span class="st">"gini"</span><span class="op">)</span>,</span>
<span>  test_ranges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An S3 object of class <code>"r3d"</code>, typically the output of <code><a href="r3d.html">r3d</a></code>.</p></dd>


<dt>X</dt>
<dd><p>Numeric vector of the running variable (the same one used in <code><a href="r3d.html">r3d</a></code>).</p></dd>


<dt>Y_list</dt>
<dd><p>A list of numeric vectors; each element in this list is the sample from the
outcome distribution of one unit (same data passed to <code><a href="r3d.html">r3d</a></code>).</p></dd>


<dt>T</dt>
<dd><p>(Optional) numeric or logical vector of treatment statuses for the fuzzy design;
used only if the original <code>r3d</code> call was fuzzy. Otherwise, can be <code>NULL</code>.</p></dd>


<dt>B</dt>
<dd><p>Integer, number of bootstrap draws. Defaults to 200.</p></dd>


<dt>alpha</dt>
<dd><p>Significance level for uniform confidence bands. Defaults to 0.05.</p></dd>


<dt>test</dt>
<dd><p>Character vector indicating which hypothesis tests to conduct:</p><dl><dt><code>"none"</code></dt>
<dd><p>No test, only compute confidence bands.</p></dd>

<dt><code>"nullity"</code></dt>
<dd><p>Tests the null \(H_0: \tau(q) = 0 \text{ for all } q\).</p></dd>

<dt><code>"homogeneity"</code></dt>
<dd><p>Tests the null \(H_0: \tau(q) \text{ is constant in } q\).</p></dd>

<dt><code>"gini"</code></dt>
<dd><p>Tests the null \(H_0: \text{Gini coefficient above} = \text{Gini coefficient below}\).</p></dd>


</dl><p>Multiple test types can be specified as a vector, e.g., <code>c("nullity", "homogeneity")</code>.</p></dd>


<dt>test_ranges</dt>
<dd><p>List of numeric vectors defining the quantile ranges for testing. Each element should be a
vector of length 2 or more defining the ranges. For example, <code>list(c(0.25, 0.75))</code> to test on
quantiles between 0.25 and 0.75, or <code>list(c(0.25, 0.5, 0.75))</code> to test on ranges \[0.25, 0.5\] and \[0.5, 0.75\].
If <code>NULL</code> (default), tests are performed on the entire <code>q_grid</code>.</p></dd>


<dt>cores</dt>
<dd><p>Number of CPU cores used for parallel computation of bootstrap draws (default 1).</p></dd>


<dt>seed</dt>
<dd><p>Optional integer to set a random seed for the multiplier draws (for reproducibility).</p></dd>


<dt>...</dt>
<dd><p>Unused additional arguments (for compatibility).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the elements:</p><dl><dt><code>cb_lower</code>, <code>cb_upper</code></dt>
<dd><p>Numeric vectors giving the lower and upper
uniform confidence bands at each quantile in <code>object$q_grid</code>.</p></dd>

<dt><code>boot_taus</code></dt>
<dd><p>A matrix of bootstrap-draw realizations of the entire \(\tau(q)\).</p></dd>

<dt><code>supvals</code></dt>
<dd><p>For each bootstrap draw, the supremum (max) absolute deviation.</p></dd>

<dt><code>crit_val</code></dt>
<dd><p>The critical value (e.g., the <code>(1 - alpha)</code> quantile of <code>supvals</code>).</p></dd>

<dt><code>test_results</code></dt>
<dd><p>If <code>test</code> is not <code>"none"</code>, a list of test results for each test
and range combination, containing the test statistic, critical value, and p-value for each test.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function implements the multiplier bootstrap approach for distributional RD:
it draws i.i.d. normal multipliers \(\xi_i\), re-scales the stored residual partial sums,
and reconstructs approximate realizations of the limiting process.
The maximum deviation across quantiles in each realization
is then used to form uniform confidence bands and test statistics.</p>
<p>For the fuzzy design, the ratio-based estimator is handled similarly, using
the same partial-sum logic for the treatment variable.</p>
<p>When multiple tests and/or multiple range specifications are provided, the function
will perform each test on each specified range, returning results for all combinations.</p>
<p>The Gini test examines whether there is a statistically significant difference between
the Gini coefficients of the estimated quantile functions above and below the cutoff.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="r3d.html">r3d</a></code>, <code><a href="plot.r3d.html">plot.r3d</a></code>, <code><a href="summary.r3d.html">summary.r3d</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Van Dijcke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

